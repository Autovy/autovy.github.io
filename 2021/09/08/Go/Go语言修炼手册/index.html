<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/gear48.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/gear32.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="true"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"autovy.github.io","root":"/","scheme":"Gemini","version":"7.7.2","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="Go的吉祥物Gopher也太可爱了叭！！！">
<meta property="og:type" content="article">
<meta property="og:title" content="Go|Go语言修炼手册">
<meta property="og:url" content="https://autovy.github.io/2021/09/08/Go/Go%E8%AF%AD%E8%A8%80%E4%BF%AE%E7%82%BC%E6%89%8B%E5%86%8C/index.html">
<meta property="og:site_name" content="Autovy&#39;s blog">
<meta property="og:description" content="Go的吉祥物Gopher也太可爱了叭！！！">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109070837021.jpeg">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109070857530.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109070940900.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109071006085.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109071015209.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109071025874.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109071034851.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109071039908.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109071105125.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109071108661.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109072134201.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109080742743.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109080812902.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109080814350.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109080815152.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109080819934.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109081521451.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109080853240.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109080905553.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109081529584.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109081532259.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109081546666.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109081630685.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109081711312.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109081652041.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109081719227.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109081723322.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109081736704.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109081734771.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109081743780.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109081744858.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109081745019.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109082013606.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109082013186.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109081934116.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109081941217.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109070739852.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109070740152.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109070744119.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109082024169.jpg">
<meta property="article:published_time" content="2021-09-08T06:30:00.000Z">
<meta property="article:modified_time" content="2021-09-08T12:59:38.337Z">
<meta property="article:author" content="Autovy">
<meta property="article:tag" content="入门教程">
<meta property="article:tag" content="后端">
<meta property="article:tag" content="Go">
<meta property="article:tag" content="面向接口">
<meta property="article:tag" content="并发编程">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109070837021.jpeg">

<link rel="canonical" href="https://autovy.github.io/2021/09/08/Go/Go%E8%AF%AD%E8%A8%80%E4%BF%AE%E7%82%BC%E6%89%8B%E5%86%8C/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true
  };
</script>

  <title>Go|Go语言修炼手册 | Autovy's blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="Autovy's blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Autovy's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">Just For Interest</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签<span class="badge">51</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类<span class="badge">11</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档<span class="badge">43</span></a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="search-pop-overlay">
  <div class="popup search-popup">
      <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

  </div>
</div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://autovy.github.io/2021/09/08/Go/Go%E8%AF%AD%E8%A8%80%E4%BF%AE%E7%82%BC%E6%89%8B%E5%86%8C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/2.png">
      <meta itemprop="name" content="Autovy">
      <meta itemprop="description" content="新时代农民工的数字农田">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Autovy's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Go|Go语言修炼手册
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021/09/08 14:30:00" itemprop="dateCreated datePublished" datetime="2021-09-08T14:30:00+08:00">2021/09/08</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Go/" itemprop="url" rel="index"><span itemprop="name">Go</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="热度" id="busuanzi_container_page_pv_test" style="display: inline;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">热度：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2021/09/08/Go/Go%E8%AF%AD%E8%A8%80%E4%BF%AE%E7%82%BC%E6%89%8B%E5%86%8C/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/09/08/Go/Go%E8%AF%AD%E8%A8%80%E4%BF%AE%E7%82%BC%E6%89%8B%E5%86%8C/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>29k</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p><img src="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109070837021.jpeg" alt="img"></p>
<p>Go的吉祥物Gopher也太可爱了叭！！！</p>
<span id="more"></span>

<p>参考文章：</p>
<p>Go语言标准库：<a target="_blank" rel="noopener" href="https://studygolang.com/pkgdoc">https://studygolang.com/pkgdoc</a></p>
<p>Go案例代码：<a target="_blank" rel="noopener" href="https://gobyexample-cn.github.io/">https://gobyexample-cn.github.io/</a></p>
<p>Go语言学习手册：<a target="_blank" rel="noopener" href="https://www.topgoer.com/">https://www.topgoer.com/</a></p>
<h3 id="HelloGo"><a href="#HelloGo" class="headerlink" title="HelloGo"></a>HelloGo</h3><h4 id="1-Golang的主要特征"><a href="#1-Golang的主要特征" class="headerlink" title="1.Golang的主要特征"></a>1.Golang的主要特征</h4><ul>
<li><p>自动立即回收</p>
</li>
<li><p>更丰富的内置类型</p>
</li>
<li><p>函数多返回值</p>
</li>
<li><p>错误处理</p>
</li>
<li><p>匿名函数和闭包</p>
</li>
<li><p>类型和接口</p>
</li>
<li><p>并发编程</p>
</li>
<li><p>反射</p>
</li>
<li><p>语言交互性</p>
</li>
</ul>
<h4 id="2-第一个Go程序"><a href="#2-第一个Go程序" class="headerlink" title="2.第一个Go程序"></a>2.第一个Go程序</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 要导入main包才能运行main函数</span></span><br><span class="line"><span class="comment">// 而且一个项目中只能有一个文件导入main包使用main函数（类似于C语言）</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Hello</span><span class="params">()</span></span>  &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;HelloGo&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="3-Go的值运算"><a href="#3-Go的值运算" class="headerlink" title="3.Go的值运算"></a>3.Go的值运算</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Value 数据值的一些运算</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Value</span><span class="params">()</span></span>  &#123;</span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">&quot;go&quot;</span>+<span class="string">&quot;lang&quot;</span>)</span><br><span class="line">	fmt.Println(<span class="string">&quot;go&quot;</span>,<span class="string">&quot;lang&quot;</span>)</span><br><span class="line">	fmt.Println(<span class="string">&quot;1+1=&quot;</span>, <span class="number">1</span>+<span class="number">1</span>)</span><br><span class="line">	fmt.Println(<span class="string">&quot;7.0/3.0&quot;</span>)</span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="literal">true</span> &amp;&amp; <span class="literal">false</span>)</span><br><span class="line">	fmt.Println(<span class="literal">true</span> || <span class="literal">false</span>)</span><br><span class="line">	fmt.Println(!<span class="literal">true</span>)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109070857530.png" alt="image-20210907085705239"></p>
<h3 id="变量与常量"><a href="#变量与常量" class="headerlink" title="变量与常量"></a>变量与常量</h3><h4 id="1-变量"><a href="#1-变量" class="headerlink" title="1.变量"></a>1.变量</h4><h5 id="（1）标准声明"><a href="#（1）标准声明" class="headerlink" title="（1）标准声明"></a>（1）标准声明</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Go语言用var声明变量</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// go推断变量类型</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="string">&quot;TestString&quot;</span></span><br><span class="line">fmt.Println(a)</span><br><span class="line"></span><br><span class="line"><span class="comment">//  变量名后声明变量类型</span></span><br><span class="line"><span class="keyword">var</span> b, c <span class="keyword">int</span> = <span class="number">1</span>, <span class="number">2</span></span><br><span class="line">fmt.Println(b, c)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> d = <span class="literal">true</span></span><br><span class="line">fmt.Println(d)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 声明变量赋给默认值</span></span><br><span class="line"><span class="keyword">var</span> e <span class="keyword">int</span></span><br><span class="line">fmt.Println(e)</span><br></pre></td></tr></table></figure>



<h5 id="（2）批量声明"><a href="#（2）批量声明" class="headerlink" title="（2）批量声明"></a>（2）批量声明</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> (</span><br><span class="line">    a <span class="keyword">string</span></span><br><span class="line">    b <span class="keyword">int</span></span><br><span class="line">    c <span class="keyword">bool</span></span><br><span class="line">    d <span class="keyword">float32</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>



<h5 id="（3）短变量声明"><a href="#（3）短变量声明" class="headerlink" title="（3）短变量声明"></a>（3）短变量声明</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 化简写法声明字符串变量f（相当于 var f string = &quot;apple&quot;）</span></span><br><span class="line">f := <span class="string">&quot;apple&quot;</span></span><br><span class="line">fmt.Println(f)</span><br></pre></td></tr></table></figure>



<h4 id="2-常量"><a href="#2-常量" class="headerlink" title="2.常量"></a>2.常量</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 声明恒定值</span></span><br><span class="line"><span class="keyword">const</span> s <span class="keyword">string</span> = <span class="string">&quot;constant&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Constants</span><span class="params">()</span></span>  &#123;</span><br><span class="line">	fmt.Println(s)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">const</span> n  = <span class="number">500000</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">const</span> d = <span class="number">3e20</span> / n</span><br><span class="line"></span><br><span class="line">	fmt.Println(d)</span><br><span class="line">	<span class="comment">// 转换类型</span></span><br><span class="line">	fmt.Println(<span class="keyword">int64</span>(d))</span><br><span class="line">	<span class="comment">// 数学运算</span></span><br><span class="line">	fmt.Println(math.Sin(n))</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>常量的声明只是将变量声明中的<code>var</code>更改为<code>const</code></p>
<h3 id="基本数据结构"><a href="#基本数据结构" class="headerlink" title="基本数据结构"></a>基本数据结构</h3><h4 id="1-数组Array"><a href="#1-数组Array" class="headerlink" title="1.数组Array"></a>1.数组Array</h4><h5 id="（1）声明默认数组"><a href="#（1）声明默认数组" class="headerlink" title="（1）声明默认数组"></a>（1）声明默认数组</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 声明默认数组</span></span><br><span class="line"><span class="keyword">var</span> a [<span class="number">5</span>]<span class="keyword">int</span></span><br><span class="line">fmt.Println(a)</span><br><span class="line"><span class="comment">// 数组元素赋值</span></span><br><span class="line">a[<span class="number">4</span>] = <span class="number">100</span></span><br><span class="line">fmt.Println(a)</span><br><span class="line">fmt.Println(a[<span class="number">4</span>])</span><br><span class="line">fmt.Println(<span class="built_in">len</span>(a))</span><br></pre></td></tr></table></figure>



<h5 id="（2）声明并初始化数组"><a href="#（2）声明并初始化数组" class="headerlink" title="（2）声明并初始化数组"></a>（2）声明并初始化数组</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 声明并初始化数组</span></span><br><span class="line">b:= [<span class="number">5</span>]<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;</span><br><span class="line"><span class="comment">// ...即让程序自动读取数组大小</span></span><br><span class="line">c:= [...]<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>&#125;</span><br><span class="line">fmt.Println(b, c)</span><br></pre></td></tr></table></figure>



<h5 id="（3）声明二维数组"><a href="#（3）声明二维数组" class="headerlink" title="（3）声明二维数组"></a>（3）声明二维数组</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 声明二维数组</span></span><br><span class="line"><span class="keyword">var</span> twoD [<span class="number">2</span>][<span class="number">3</span>]<span class="keyword">int</span></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">2</span>; i++&#123;</span><br><span class="line">    <span class="keyword">for</span> j:=<span class="number">0</span>; j &lt; <span class="number">3</span>; j++ &#123;</span><br><span class="line">    	twoD[i][j] = i + j</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fmt.Println(twoD)</span><br></pre></td></tr></table></figure>



<h4 id="2-切片Slice"><a href="#2-切片Slice" class="headerlink" title="2.切片Slice"></a>2.切片Slice</h4><h5 id="（1）切片简介"><a href="#（1）切片简介" class="headerlink" title="（1）切片简介"></a>（1）切片简介</h5><ul>
<li>切片是 Go 中的一种关键数据类型（引用类型），它为序列提供了比数组更强大的接口</li>
<li>切片的长度可以改变，因此，切片是一个可变的数组</li>
<li>切片遍历方式和数组一样，可以用len()求长度。表示可用元素数量，读写操作不能超过该限制</li>
</ul>
<h5 id="（2）切片一般声明"><a href="#（2）切片一般声明" class="headerlink" title="（2）切片一般声明"></a>（2）切片一般声明</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 声明切片（让数组长度为空即形成切片）</span></span><br><span class="line"><span class="keyword">var</span> s1 []<span class="keyword">int</span></span><br><span class="line">s2 := []<span class="keyword">int</span>&#123;<span class="number">2</span>,<span class="number">4</span>,<span class="number">5</span>&#125;</span><br><span class="line">fmt.Println(s1, s2)</span><br></pre></td></tr></table></figure>



<h5 id="（3）make创建"><a href="#（3）make创建" class="headerlink" title="（3）make创建"></a>（3）make创建</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 声明非0长度的空片，需要用内置的make函数</span></span><br><span class="line"><span class="comment">// make([]type, len, cap):len（长度），cap（容量即为切片最长长度，可选）</span></span><br><span class="line"><span class="comment">// cap可以求出slice最大扩张容量，不能超出数组限制。len(slice) &gt;= len(array)，其中array是slice引用的数组</span></span><br><span class="line">s3 := <span class="built_in">make</span>([]<span class="keyword">string</span>, <span class="number">5</span>, <span class="number">6</span>)</span><br><span class="line">fmt.Println(s3)</span><br><span class="line">fmt.Println(<span class="built_in">len</span>(s3),<span class="built_in">cap</span>(s3))</span><br></pre></td></tr></table></figure>



<h5 id="（4）切片赋值与追加"><a href="#（4）切片赋值与追加" class="headerlink" title="（4）切片赋值与追加"></a>（4）切片赋值与追加</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 切片赋值（虽然切片可以自动扩容，但是取索引时不会扩容）</span></span><br><span class="line">s3[<span class="number">0</span>] = <span class="string">&quot;a&quot;</span></span><br><span class="line">s3[<span class="number">4</span>] = <span class="string">&quot;b&quot;</span></span><br><span class="line">fmt.Println(s3)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 向切片中追加元素（必须接受返回值，在追加时可能使切片的容量增大）</span></span><br><span class="line">s3 = <span class="built_in">append</span>(s3, <span class="string">&quot;d&quot;</span>)</span><br><span class="line">s3 = <span class="built_in">append</span>(s3, <span class="string">&quot;e&quot;</span>,<span class="string">&quot;f&quot;</span>)</span><br><span class="line"><span class="comment">// 切片可以追加其他切片或数组使用...解压缩</span></span><br><span class="line">s3 = <span class="built_in">append</span>(s3, s3...)</span><br><span class="line">fmt.Println(s3)</span><br></pre></td></tr></table></figure>



<h5 id="（5）切片复制"><a href="#（5）切片复制" class="headerlink" title="（5）切片复制"></a>（5）切片复制</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 切片复制</span></span><br><span class="line">c := <span class="built_in">make</span>([]<span class="keyword">string</span>, <span class="built_in">len</span>(s3))</span><br><span class="line"><span class="built_in">copy</span>(c, s3)</span><br><span class="line">fmt.Println(c)</span><br></pre></td></tr></table></figure>



<h5 id="（6）由数组或切片获得切片"><a href="#（6）由数组或切片获得切片" class="headerlink" title="（6）由数组或切片获得切片"></a>（6）由数组或切片获得切片</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 由数组或切片获得切片</span></span><br><span class="line"><span class="comment">// 获得s3的5，6元素</span></span><br><span class="line">l := s3[<span class="number">5</span>:<span class="number">7</span>]</span><br><span class="line">fmt.Println(l)</span><br><span class="line"><span class="comment">// 去掉切片最后一个元素</span></span><br><span class="line">l = s3[:<span class="built_in">len</span>(s3)<span class="number">-1</span>]</span><br><span class="line">fmt.Println(l)</span><br></pre></td></tr></table></figure>



<h4 id="3-Map"><a href="#3-Map" class="headerlink" title="3.Map"></a>3.Map</h4><h5 id="（1）map的创建"><a href="#（1）map的创建" class="headerlink" title="（1）map的创建"></a>（1）map的创建</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建空地图（键类型为string，值类型为int）</span></span><br><span class="line">m := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">int</span>)</span><br><span class="line">m1 := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">int</span>]<span class="keyword">string</span>)</span><br></pre></td></tr></table></figure>



<h5 id="（2）map初始化"><a href="#（2）map初始化" class="headerlink" title="（2）map初始化"></a>（2）map初始化</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// map初始化</span></span><br><span class="line">n := <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>&#123;<span class="string">&quot;foo&quot;</span>:<span class="string">&quot;str1&quot;</span>, <span class="string">&quot;bar&quot;</span>:<span class="string">&quot;str2&quot;</span>&#125;</span><br><span class="line">fmt.Println(n)</span><br></pre></td></tr></table></figure>



<h5 id="（3）map赋值与取值"><a href="#（3）map赋值与取值" class="headerlink" title="（3）map赋值与取值"></a>（3）map赋值与取值</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// map键值对赋值</span></span><br><span class="line">m[<span class="string">&quot;k1&quot;</span>] = <span class="number">7</span></span><br><span class="line">m[<span class="string">&quot;k2&quot;</span>] = <span class="number">10</span></span><br><span class="line"><span class="comment">// map的键为整型时区别于数组</span></span><br><span class="line">m1[<span class="number">1</span>] = <span class="string">&quot;test1&quot;</span></span><br><span class="line">m1[<span class="number">10</span>] = <span class="string">&quot;test2&quot;</span></span><br><span class="line">fmt.Println(m)</span><br><span class="line">fmt.Println(m1)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 取值</span></span><br><span class="line">v1 := m[<span class="string">&quot;k1&quot;</span>]</span><br><span class="line">fmt.Println(v1)</span><br></pre></td></tr></table></figure>

<p>不存在取值的返回：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 不存在的键值默认返回为0，加上_,返回fasle（下划线用来忽略结果，也可以理解为那个位置本应赋给某个值，但是咱们不需要这个值）</span></span><br><span class="line">prs := m[<span class="string">&quot;k2&quot;</span>]</span><br><span class="line">_,prs2 := m[<span class="string">&quot;k2&quot;</span>]</span><br><span class="line">fmt.Println(prs, prs2)</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109070940900.png" alt="image-20210907094003976"></p>
<h5 id="（4）map删除操作"><a href="#（4）map删除操作" class="headerlink" title="（4）map删除操作"></a>（4）map删除操作</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 删除（map限定，不存在的键自动略过不报错）</span></span><br><span class="line"><span class="built_in">delete</span>(m, <span class="string">&quot;k2&quot;</span>)</span><br><span class="line">fmt.Println(m)</span><br></pre></td></tr></table></figure>





<h3 id="基本流程控制"><a href="#基本流程控制" class="headerlink" title="基本流程控制"></a>基本流程控制</h3><h4 id="1-if语句"><a href="#1-if语句" class="headerlink" title="1.if语句"></a>1.if语句</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">If</span><span class="params">(str <span class="keyword">string</span>)</span></span>  &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// if语句</span></span><br><span class="line">	<span class="keyword">if</span> str==<span class="string">&quot;IfA&quot;</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;a条件&quot;</span>)</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;其他条件&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 声明可以先于条件</span></span><br><span class="line">	<span class="keyword">if</span> str = <span class="string">&quot;IfA&quot;</span>; str==<span class="string">&quot;IfA&quot;</span>&#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;a条件满足&quot;</span>)</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="2-switch语句"><a href="#2-switch语句" class="headerlink" title="2.switch语句"></a>2.switch语句</h4><h5 id="（1）使用变量作为判定条件"><a href="#（1）使用变量作为判定条件" class="headerlink" title="（1）使用变量作为判定条件"></a>（1）使用变量作为判定条件</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// switch基本案例,使用变量作为判定条件</span></span><br><span class="line">i := <span class="number">2</span></span><br><span class="line">fmt.Println(<span class="string">&quot;write&quot;</span>, i, <span class="string">&quot;as&quot;</span>)</span><br><span class="line">    <span class="keyword">switch</span> i &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">    fmt.Println(<span class="string">&quot;one&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">    fmt.Println(<span class="string">&quot;two&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">    fmt.Println(<span class="string">&quot;three&quot;</span>)</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h5 id="（2）使用函数返回的变量值作为expression"><a href="#（2）使用函数返回的变量值作为expression" class="headerlink" title="（2）使用函数返回的变量值作为expression"></a>（2）使用函数返回的变量值作为expression</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用函数返回的变量值作为expression</span></span><br><span class="line"><span class="comment">// Weekday返回周数（weekday类型）</span></span><br><span class="line"><span class="keyword">switch</span> time.Now().Weekday()&#123;</span><br><span class="line">    <span class="keyword">case</span> time.Saturday, time.Sunday:</span><br><span class="line">    fmt.Println(<span class="string">&quot;weekend&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">    fmt.Println(<span class="string">&quot;weekday&quot;</span>)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="（3）使用函数返回值的变量作为constant-expression"><a href="#（3）使用函数返回值的变量作为constant-expression" class="headerlink" title="（3）使用函数返回值的变量作为constant-expression"></a>（3）使用函数返回值的变量作为constant-expression</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用函数返回值的变量作为constant-expression</span></span><br><span class="line">t := time.Now()</span><br><span class="line"><span class="keyword">switch</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">case</span> t.Hour() &gt;= <span class="number">6</span> &amp;&amp; t.Hour() &lt; <span class="number">8</span>:</span><br><span class="line">    fmt.Println(<span class="string">&quot;清晨&quot;</span>)</span><br><span class="line">    <span class="keyword">case</span> t.Hour() &gt;= <span class="number">8</span> &amp;&amp; t.Hour() &lt; <span class="number">12</span>:</span><br><span class="line">    fmt.Println(<span class="string">&quot;早上&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">    fmt.Println(<span class="string">&quot;其他时间&quot;</span>)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="3-for语句"><a href="#3-for语句" class="headerlink" title="3.for语句"></a>3.for语句</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">For</span><span class="params">()</span></span>  &#123;</span><br><span class="line"></span><br><span class="line">	i := <span class="number">1</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// 只要i小于等于3就一直执行循环</span></span><br><span class="line">	<span class="keyword">for</span> i &lt;= <span class="number">3</span>&#123;</span><br><span class="line">		fmt.Println(i)</span><br><span class="line">		i = i + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 经典for语句初始/条件/后循环</span></span><br><span class="line">	<span class="keyword">for</span> j := <span class="number">7</span>; j &lt;= <span class="number">9</span>; j++&#123;</span><br><span class="line">		fmt.Println(j)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 无条件for循环等待break终止</span></span><br><span class="line">	<span class="keyword">for</span>&#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;loop&quot;</span>)</span><br><span class="line">		<span class="keyword">break</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> n:= <span class="number">0</span>; n &lt;= <span class="number">5</span>; n++&#123;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 复数进入下个循环</span></span><br><span class="line">		<span class="keyword">if</span> n%<span class="number">2</span> == <span class="number">0</span> &#123;</span><br><span class="line">			<span class="keyword">continue</span></span><br><span class="line">		&#125;</span><br><span class="line">		fmt.Println(n)</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="4-Range语句"><a href="#4-Range语句" class="headerlink" title="4.Range语句"></a>4.Range语句</h4><h5 id="（1）Range简介"><a href="#（1）Range简介" class="headerlink" title="（1）Range简介"></a>（1）Range简介</h5><ul>
<li>range类似迭代器操作，返回 (索引, 值) 或 (键, 值)</li>
<li>range 格式可以对 slice、map、数组、字符串等进行迭代循环</li>
</ul>
<h5 id="（2）数组遍历"><a href="#（2）数组遍历" class="headerlink" title="（2）数组遍历"></a>（2）数组遍历</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">nums := []<span class="keyword">int</span>&#123;<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;</span><br><span class="line">sum := <span class="number">0</span></span><br><span class="line"><span class="comment">// 遍历数组</span></span><br><span class="line"><span class="comment">//range会提供索引和值，这里我们不需要索引所以用占位符代替</span></span><br><span class="line"><span class="keyword">for</span> _, num := <span class="keyword">range</span> nums&#123;</span><br><span class="line">sum += num</span><br><span class="line">&#125;</span><br><span class="line">fmt.Println(sum)</span><br></pre></td></tr></table></figure>



<h5 id="（3）map遍历"><a href="#（3）map遍历" class="headerlink" title="（3）map遍历"></a>（3）map遍历</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 遍历map</span></span><br><span class="line">kvs := <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>&#123;<span class="string">&quot;a&quot;</span>:<span class="string">&quot;Ava&quot;</span>, <span class="string">&quot;b&quot;</span>:<span class="string">&quot;Bella&quot;</span>, <span class="string">&quot;c&quot;</span>:<span class="string">&quot;Carol&quot;</span>, <span class="string">&quot;d&quot;</span>:<span class="string">&quot;Diana&quot;</span>, <span class="string">&quot;e&quot;</span>:<span class="string">&quot;Eileen&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k, v := <span class="keyword">range</span> kvs&#123;</span><br><span class="line">	fmt.Printf(<span class="string">&quot;%s : %s\n&quot;</span>, k, v)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 遍历键</span></span><br><span class="line"><span class="keyword">for</span> k := <span class="keyword">range</span> kvs&#123;</span><br><span class="line">	fmt.Println(k)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 遍历值</span></span><br><span class="line"><span class="keyword">for</span> _,v := <span class="keyword">range</span> kvs&#123;</span><br><span class="line">	fmt.Println(v)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h3><h4 id="1-多参数"><a href="#1-多参数" class="headerlink" title="1.多参数"></a>1.多参数</h4><h5 id="（1）两参数"><a href="#（1）两参数" class="headerlink" title="（1）两参数"></a>（1）两参数</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 函数接受两个int参数，返回值为int</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">plus</span><span class="params">(a <span class="keyword">int</span>, b <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> a + b</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="（2）同类型多参数"><a href="#（2）同类型多参数" class="headerlink" title="（2）同类型多参数"></a>（2）同类型多参数</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 接受多个同类型参数时</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">plusPlus</span><span class="params">(a, b, c <span class="keyword">int</span>)</span> <span class="title">string</span></span>&#123;</span><br><span class="line">	<span class="comment">// 使用strconv包将整型转换成字符串（强制类型转换会出现乱码）</span></span><br><span class="line">	a1 := strconv.Itoa(a)</span><br><span class="line">	b1 := strconv.Itoa(b)</span><br><span class="line">	c1 := strconv.Itoa(c)</span><br><span class="line">	<span class="keyword">return</span> a1 + b1 + c1</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="（3）可变参数"><a href="#（3）可变参数" class="headerlink" title="（3）可变参数"></a>（3）可变参数</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 可变参数（不定数量参数）,只能作为最后的参数项</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sum</span><span class="params">(str <span class="keyword">string</span>, nums ...<span class="keyword">int</span>)</span></span>  &#123;</span><br><span class="line"></span><br><span class="line">		fmt.Println(str, nums)</span><br><span class="line">		total := <span class="number">0</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> _,num := <span class="keyword">range</span> nums&#123;</span><br><span class="line">			total += num</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		fmt.Println(total)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="2-多返回值"><a href="#2-多返回值" class="headerlink" title="2.多返回值"></a>2.多返回值</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 多个返回值的函数</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">vals</span><span class="params">(a, b <span class="keyword">int</span>)</span> <span class="params">(<span class="keyword">int</span>, <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	add := a + b</span><br><span class="line">	sub := a - b</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> add, sub</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h4 id="3-闭包函数"><a href="#3-闭包函数" class="headerlink" title="3.闭包函数"></a>3.闭包函数</h4><h5 id="（1）声明"><a href="#（1）声明" class="headerlink" title="（1）声明"></a>（1）声明</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 匿名函数形成闭包</span></span><br><span class="line"><span class="comment">// 匿名函数常用于赋给变量，像普通变量一样传递操作</span></span><br><span class="line"><span class="comment">// 闭包最终效果就是将闭包赋予变量后，通过调用变量调用闭包函数</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">intSeq</span><span class="params">()</span> <span class="title">func</span><span class="params">()</span> <span class="title">int</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	i := <span class="number">0</span></span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">()</span> <span class="title">int</span></span> &#123;</span><br><span class="line">		i++</span><br><span class="line">		<span class="keyword">return</span> i</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="（2）调用"><a href="#（2）调用" class="headerlink" title="（2）调用"></a>（2）调用</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 变量赋予闭包，变量可以作为函数使用</span></span><br><span class="line">nextInt := intSeq()</span><br><span class="line"><span class="comment">// intSeq()输出的是原对象指针</span></span><br><span class="line">fmt.Println(intSeq())</span><br><span class="line">fmt.Println(nextInt())</span><br><span class="line">fmt.Println(nextInt())</span><br><span class="line">nextInt2 := intSeq()</span><br><span class="line">fmt.Println(nextInt2())</span><br></pre></td></tr></table></figure>



<h5 id="（3）结果"><a href="#（3）结果" class="headerlink" title="（3）结果"></a>（3）结果</h5><p><img src="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109071006085.png" alt="image-20210907100638778"></p>
<h4 id="4-递归函数"><a href="#4-递归函数" class="headerlink" title="4.递归函数"></a>4.递归函数</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 递归计算阶乘</span></span><br><span class="line"><span class="comment">// 递归函数特征</span></span><br><span class="line"><span class="comment">// 1.子问题须与原始问题为同样的事，且更为简单。</span></span><br><span class="line"><span class="comment">// 2.不能无限制地调用本身，须有个出口，化简为非递归状况处理。</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">fact</span><span class="params">(n <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">	<span class="keyword">if</span> n == <span class="number">0</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> n * fact(n<span class="number">-1</span>)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="指针"><a href="#指针" class="headerlink" title="指针"></a>指针</h3><h4 id="1-函数中的指针参数"><a href="#1-函数中的指针参数" class="headerlink" title="1.函数中的指针参数"></a>1.函数中的指针参数</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 普通参数是将值传递给函数，相当于复制了副本</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">zeroval</span><span class="params">(ival <span class="keyword">int</span>)</span></span>  &#123;</span><br><span class="line"></span><br><span class="line">		ival = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 用指针作为参数，函数直接操作参数的内存地址</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">zeroptr</span><span class="params">(iptr *<span class="keyword">int</span>)</span></span>  &#123;</span><br><span class="line"></span><br><span class="line">	fmt.Println(iptr)</span><br><span class="line">	<span class="comment">// 引用当前地址的值并修改</span></span><br><span class="line">	*iptr = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="2-调用与运行结果"><a href="#2-调用与运行结果" class="headerlink" title="2.调用与运行结果"></a>2.调用与运行结果</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">i := <span class="number">1</span></span><br><span class="line"></span><br><span class="line">zeroval(i)</span><br><span class="line">fmt.Println(i)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 取变量地址作为参数</span></span><br><span class="line">zeroptr(&amp;i)</span><br><span class="line">fmt.Println(i)</span><br><span class="line">fmt.Println(&amp;i)</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109071015209.png" alt="image-20210907101514269"></p>
<h3 id="结构体"><a href="#结构体" class="headerlink" title="结构体"></a>结构体</h3><h4 id="1-结构体简介"><a href="#1-结构体简介" class="headerlink" title="1.结构体简介"></a>1.结构体简介</h4><p>Go语言中没有“类”的概念，也不支持“类”的继承等面向对象的概念。Go语言中通过结构体的内嵌再配合接口比面向对象具有更高的扩展性和灵活性</p>
<h4 id="2-结构体实例化"><a href="#2-结构体实例化" class="headerlink" title="2.结构体实例化"></a>2.结构体实例化</h4><h5 id="（1）声明结构体"><a href="#（1）声明结构体" class="headerlink" title="（1）声明结构体"></a>（1）声明结构体</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 结构体是字段的类型化集合，它们可以将数据组合在一起形成记录</span></span><br><span class="line"><span class="keyword">type</span> person <span class="keyword">struct</span> &#123;</span><br><span class="line"></span><br><span class="line">	name <span class="keyword">string</span></span><br><span class="line">	age <span class="keyword">int</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="（2）结构体实例化"><a href="#（2）结构体实例化" class="headerlink" title="（2）结构体实例化"></a>（2）结构体实例化</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 结构体实例化方法</span></span><br><span class="line">fmt.Println(person&#123;<span class="string">&quot;Bob&quot;</span>, <span class="number">20</span>&#125;)</span><br><span class="line">s := person&#123;name: <span class="string">&quot;Sean&quot;</span>, age: <span class="number">50</span>&#125;</span><br><span class="line">fmt.Println(s.name)</span><br></pre></td></tr></table></figure>

<p>输出结果</p>
<p><img src="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109071025874.png" alt="image-20210907102546338"></p>
<h5 id="（3）结构体地址"><a href="#（3）结构体地址" class="headerlink" title="（3）结构体地址"></a>（3）结构体地址</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 结构体地址</span></span><br><span class="line">fmt.Println(&amp;person&#123;name: <span class="string">&quot;Ava&quot;</span>&#125;)</span><br><span class="line">sp := &amp;s</span><br><span class="line">fmt.Println(sp)</span><br></pre></td></tr></table></figure>

<p>输出结果</p>
<p><img src="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109071034851.png" alt="image-20210907103421612"></p>
<h4 id="3-构造函数"><a href="#3-构造函数" class="headerlink" title="3.构造函数"></a>3.构造函数</h4><h5 id="（1）构造方法"><a href="#（1）构造方法" class="headerlink" title="（1）构造方法"></a>（1）构造方法</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// newPerson给定的名称一个新的person结构体</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">newPerson</span><span class="params">(name <span class="keyword">string</span>)</span> *<span class="title">person</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 声明新的结构体并赋值</span></span><br><span class="line">	p := person&#123;name:name&#125;</span><br><span class="line">	p.age = <span class="number">42</span></span><br><span class="line">	<span class="comment">// 返回新结构体的位置</span></span><br><span class="line">	<span class="keyword">return</span> &amp;p</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="（2）调用与结果"><a href="#（2）调用与结果" class="headerlink" title="（2）调用与结果"></a>（2）调用与结果</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fmt.Println(newPerson(<span class="string">&quot;Bella&quot;</span>))</span><br></pre></td></tr></table></figure>

<p>输出结果</p>
<p><img src="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109071039908.png" alt="image-20210907103904793"></p>
<h4 id="4-结构体方法"><a href="#4-结构体方法" class="headerlink" title="4.结构体方法"></a>4.结构体方法</h4><ul>
<li>对于普通函数，接收者为值类型时，不能将指针类型的数据直接传递，反之亦然</li>
<li>对于方法（如struct的方法），接收者为值类型时，可以直接用指针类型的变量调用方法</li>
<li>为了减少内存开销，一般用指针类型作为接收者，用指针变量调用方法</li>
</ul>
<h5 id="（1）定义结构体"><a href="#（1）定义结构体" class="headerlink" title="（1）定义结构体"></a>（1）定义结构体</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义结构体的方法</span></span><br><span class="line"><span class="keyword">type</span> rect <span class="keyword">struct</span> &#123;</span><br><span class="line">	width, height <span class="keyword">int</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="（2）指针接收类型方法"><a href="#（2）指针接收类型方法" class="headerlink" title="（2）指针接收类型方法"></a>（2）指针接收类型方法</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 指针接收器类型</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r *rect)</span> <span class="title">area</span><span class="params">()</span> <span class="title">int</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> r.width * r.height</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>调用：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 值类型调用方法</span></span><br><span class="line">fmt.Println(<span class="string">&quot;area&quot;</span>, r.area())</span><br><span class="line"><span class="comment">// 指针类型调用方法</span></span><br><span class="line">rp := &amp;r</span><br><span class="line">fmt.Println(<span class="string">&quot;area&quot;</span>, rp.area())</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109071105125.png" alt="image-20210907110512031"></p>
<h5 id="（3）值接收类型方法"><a href="#（3）值接收类型方法" class="headerlink" title="（3）值接收类型方法"></a>（3）值接收类型方法</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 值接收器类型</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r rect)</span> <span class="title">perim</span><span class="params">()</span> <span class="title">int</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">2</span> * r.width + <span class="number">2</span> * r.height</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>调用：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 值类型调用方法</span></span><br><span class="line">fmt.Println(<span class="string">&quot;perim&quot;</span>, r.perim())</span><br><span class="line"><span class="comment">// 指针类型调用方法</span></span><br><span class="line">fmt.Println(<span class="string">&quot;perim&quot;</span>, rp.perim())</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109071108661.png" alt="image-20210907110638342"></p>
<h3 id="接口"><a href="#接口" class="headerlink" title="接口"></a>接口</h3><h4 id="1-接口简介"><a href="#1-接口简介" class="headerlink" title="1.接口简介"></a>1.接口简介</h4><ul>
<li>接口（interface）定义了一个对象的行为规范，只定义规范不实现，由具体的对象来实现规范的细节</li>
<li>interface是一组method的集合，是duck-type programming的一种体现。接口做的事情就像是定义一个协议（规则）</li>
</ul>
<h4 id="2-接口的实现"><a href="#2-接口的实现" class="headerlink" title="2.接口的实现"></a>2.接口的实现</h4><h5 id="（1）定义接口"><a href="#（1）定义接口" class="headerlink" title="（1）定义接口"></a>（1）定义接口</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// go语言提倡面向接口编程</span></span><br><span class="line"><span class="comment">// 接口是一种抽象类型，定义对象的行为规范</span></span><br><span class="line"><span class="keyword">type</span> Gemoetry <span class="keyword">interface</span> &#123;</span><br><span class="line">	area() <span class="keyword">float64</span></span><br><span class="line">	perim() <span class="keyword">float64</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="（2）构建结构体（用于生成对象）"><a href="#（2）构建结构体（用于生成对象）" class="headerlink" title="（2）构建结构体（用于生成对象）"></a>（2）构建结构体（用于生成对象）</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 构建结构体</span></span><br><span class="line"><span class="keyword">type</span> rect2 <span class="keyword">struct</span> &#123;</span><br><span class="line">	width, height <span class="keyword">float64</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> circle <span class="keyword">struct</span> &#123;</span><br><span class="line">	radius <span class="keyword">float64</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h5 id="（3）结构体的方法实现接口"><a href="#（3）结构体的方法实现接口" class="headerlink" title="（3）结构体的方法实现接口"></a>（3）结构体的方法实现接口</h5><p>只要对象实现了接口中所有的方法，就是实现了这个接口</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 只要对象实现了接口中所有的方法，就是实现了这个接口（不需要显性声明）</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r rect2)</span> <span class="title">area</span><span class="params">()</span> <span class="title">float64</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> r.width * r.height</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r rect2)</span> <span class="title">perim</span><span class="params">()</span> <span class="title">float64</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">2</span>*r.width + <span class="number">2</span>*r.height</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c circle)</span> <span class="title">area</span><span class="params">()</span> <span class="title">float64</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> math.Pi * c.radius * c.radius</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c circle)</span> <span class="title">perim</span><span class="params">()</span> <span class="title">float64</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">2</span> * math.Pi * c.radius</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="（4）-结构体实例化生成对象"><a href="#（4）-结构体实例化生成对象" class="headerlink" title="（4） 结构体实例化生成对象"></a>（4） 结构体实例化生成对象</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 实现接口后，接口类型变量可以存储所有实现该接口的实例</span></span><br><span class="line"><span class="keyword">var</span> x Gemoetry</span><br><span class="line"></span><br><span class="line">x = rect2&#123;width: <span class="number">3</span>, height: <span class="number">4</span>&#125;</span><br><span class="line">fmt.Println(x.area())</span><br><span class="line">fmt.Println(x.perim())</span><br><span class="line"></span><br><span class="line">x = circle&#123;radius:<span class="number">5</span>&#125;</span><br><span class="line">fmt.Println(x.area())</span><br><span class="line">fmt.Println(x.perim())</span><br></pre></td></tr></table></figure>



<h3 id="异常处理"><a href="#异常处理" class="headerlink" title="异常处理"></a>异常处理</h3><p>go语言通过显式的返回值传递错误</p>
<h4 id="1-内置接口返回错误信息"><a href="#1-内置接口返回错误信息" class="headerlink" title="1.内置接口返回错误信息"></a>1.内置接口返回错误信息</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 参数arg，返回值类型int，error</span></span><br><span class="line"><span class="comment">// 使用内置接口返回错误信息</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">f1</span><span class="params">(arg <span class="keyword">int</span>)</span><span class="params">(<span class="keyword">int</span>, error)</span></span>  &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> arg == <span class="number">42</span>&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="number">-1</span>, errors.New(<span class="string">&quot;can&#x27;t work&quot;</span>)</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> arg + <span class="number">3</span>, <span class="literal">nil</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="2-自定义结构体"><a href="#2-自定义结构体" class="headerlink" title="2.自定义结构体"></a>2.自定义结构体</h4><h5 id="（1）定义结构体-1"><a href="#（1）定义结构体-1" class="headerlink" title="（1）定义结构体"></a>（1）定义结构体</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 自定义结构体实现 Error ()方法，可以显示表示错误</span></span><br><span class="line"><span class="keyword">type</span> argError <span class="keyword">struct</span>&#123;</span><br><span class="line">	arg <span class="keyword">int</span></span><br><span class="line">	prob <span class="keyword">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="（2）定义结构体方法"><a href="#（2）定义结构体方法" class="headerlink" title="（2）定义结构体方法"></a>（2）定义结构体方法</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义结构体的方法</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(e *argError)</span> <span class="title">Error</span><span class="params">()</span> <span class="title">string</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> fmt.Sprintf(<span class="string">&quot;%d - %s&quot;</span>, e.arg, e.prob)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="（3）异常测试方法"><a href="#（3）异常测试方法" class="headerlink" title="（3）异常测试方法"></a>（3）异常测试方法</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 参数arg，返回值类型int，error</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">f2</span><span class="params">(arg <span class="keyword">int</span>)</span><span class="params">(<span class="keyword">int</span>, error)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> arg == <span class="number">42</span>&#123;</span><br><span class="line">		<span class="comment">// 实例化argError返回指针error（执行函数Error）</span></span><br><span class="line">		<span class="keyword">return</span> <span class="number">-1</span>, &amp;argError&#123;arg, <span class="string">&quot;cam&#x27;t work with it&quot;</span>&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> arg + <span class="number">3</span>, <span class="literal">nil</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="（4）测试用例"><a href="#（4）测试用例" class="headerlink" title="（4）测试用例"></a>（4）测试用例</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">r,e = f2(<span class="number">42</span>)</span><br><span class="line">fmt.Println(r, e)</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109072134201.png" alt="image-20210907213437028"></p>
<h3 id="并发编程"><a href="#并发编程" class="headerlink" title="并发编程"></a>并发编程</h3><h4 id="1-Goroutines（协程）"><a href="#1-Goroutines（协程）" class="headerlink" title="1.Goroutines（协程）"></a>1.Goroutines（协程）</h4><h5 id="（1）协程简介"><a href="#（1）协程简介" class="headerlink" title="（1）协程简介"></a>（1）协程简介</h5><ul>
<li><code>go func()</code>这种形式即可实现创建一个新的协程执行函数</li>
<li>一般函数调用是阻塞主线程的，即为同步；而使用协程调用函数，则会与主线程，其他协程一起运行，则是一个异步的过程</li>
<li>在并发编程中，不能用顺序执行语句的同步思维。在多个程序同时运行时，要考虑到各个协程开始的时间和结束的时间决定的运行结果，各个协程对同一数据的同时操作，各个协程任务同步，以及主线程结束后会关闭其他协程（不管其任务是否执行完毕）的问题</li>
</ul>
<h5 id="（2）运行案例"><a href="#（2）运行案例" class="headerlink" title="（2）运行案例"></a>（2）运行案例</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">f</span><span class="params">(from <span class="keyword">string</span>)</span></span>  &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">5</span>; i++&#123;</span><br><span class="line">		fmt.Println(from, <span class="string">&quot;:&quot;</span>, i)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Goroutines</span><span class="params">()</span></span>  &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 一般调用同步运行</span></span><br><span class="line">	f(<span class="string">&quot;direct&quot;</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 将函数放到goroutine运行（Go程序会智能地将 goroutine 中的任务合理地分配给每个CPU）</span></span><br><span class="line">	<span class="keyword">go</span> f(<span class="string">&quot;goroutine&quot;</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 为匿名函数启动一个goroutine（最后完成调用）</span></span><br><span class="line">	<span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">(msg <span class="keyword">string</span>)</span></span> &#123;</span><br><span class="line">		fmt.Println(msg)</span><br><span class="line">	&#125;(<span class="string">&quot;going&quot;</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 必须设置等待，使主线程阻塞，否则main()执行完后goroutine也一同结束了</span></span><br><span class="line">	time.Sleep(time.Millisecond)</span><br><span class="line">	fmt.Println(<span class="string">&quot;done&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109080742743.png" alt="image-20210908074235644"></p>
<h4 id="2-Channels（通道）"><a href="#2-Channels（通道）" class="headerlink" title="2.Channels（通道）"></a>2.Channels（通道）</h4><h5 id="（1）通道简介"><a href="#（1）通道简介" class="headerlink" title="（1）通道简介"></a>（1）通道简介</h5><ul>
<li>通过goroutines可以实现函数并发运行，而这些并发执行的函数可以通过channels交换数据</li>
<li>默认情况下，通道是无缓冲的（阻塞通道），无缓冲的通道必须有接收才能发送</li>
<li>使用make函数初始化通道的时候为其指定通道的容量即可生成有缓冲通道</li>
</ul>
<h5 id="（2）通道的发送与接收"><a href="#（2）通道的发送与接收" class="headerlink" title="（2）通道的发送与接收"></a>（2）通道的发送与接收</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// channel是一种类型，一种引用类型</span></span><br><span class="line"><span class="comment">// 声明并初始化channel（声明的通道后需要使用make函数初始化之后才能使用）</span></span><br><span class="line">messages := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">string</span>)</span><br><span class="line">fmt.Println(reflect.TypeOf(messages), messages)</span><br><span class="line"></span><br><span class="line"><span class="comment">// goroutines中函数将信息发送到messages通道</span></span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;messages &lt;- <span class="string">&quot;ping&quot;</span>&#125;()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 接收信息</span></span><br><span class="line">msg := &lt;-messages</span><br><span class="line">fmt.Println(reflect.TypeOf(msg), msg)</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109080812902.png" alt="image-20210908081215613"></p>
<h5 id="（3）无缓冲通道"><a href="#（3）无缓冲通道" class="headerlink" title="（3）无缓冲通道"></a>（3）无缓冲通道</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 默认情况下，通道是无缓冲的（阻塞通道），无缓冲的通道必须有接收才能发送</span></span><br><span class="line">ch := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>)</span><br><span class="line">ch &lt;- <span class="number">10</span></span><br><span class="line">fmt.Println(<span class="string">&quot;发送成功&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109080814350.png" alt="image-20210908081412049"></p>
<p>无缓冲通道原理图：</p>
<p>无缓冲相当于小区没有快递点，快递员必须亲自把这个物品送到你的手上</p>
<p><img src="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109080815152.png" alt="img"></p>
<h5 id="（4）有缓冲通道"><a href="#（4）有缓冲通道" class="headerlink" title="（4）有缓冲通道"></a>（4）有缓冲通道</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用make函数初始化通道的时候为其指定通道的容量即可生成有缓冲通道</span></span><br><span class="line"><span class="comment">// 有缓冲通道（相当于设置了快递点）</span></span><br><span class="line">ch := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>, <span class="number">2</span>)</span><br><span class="line">ch &lt;- <span class="number">10</span></span><br><span class="line">ch &lt;- <span class="number">20</span></span><br><span class="line">fmt.Println(<span class="string">&quot;发送成功&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>有缓冲通道原理图：</p>
<p>有缓冲通道相当于小区有个菜鸟驿站（非广告）或代收点帮你存快递，需要时再去取快递</p>
<p><img src="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109080819934.png" alt="img"></p>
<h5 id="（5）信道同步"><a href="#（5）信道同步" class="headerlink" title="（5）信道同步"></a>（5）信道同步</h5><p>在协程中存在着主线程结束后不管子协程有没有完成任务仍然让其强制下班的问题</p>
<p>虽然可以通过时间延迟让主线程嗯等，但是这种硬性处理方式浪费资源</p>
<p>通过信道，我们可以让主线程等待子协程发送任务完成的信号再结束自己的生命</p>
<p>子协程任务：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 信道同步</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">worker</span><span class="params">(done <span class="keyword">chan</span> <span class="keyword">bool</span>)</span></span>&#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;working&quot;</span>)</span><br><span class="line">	time.Sleep(time.Second)</span><br><span class="line">	fmt.Println(<span class="string">&quot;done&quot;</span>)</span><br><span class="line">    <span class="comment">// 发送任务完成的信号到通道</span></span><br><span class="line">	done &lt;- <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>主线程的运行：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 信道同步</span></span><br><span class="line">done := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">bool</span>, <span class="number">1</span>)</span><br><span class="line"><span class="keyword">go</span> worker(done)</span><br><span class="line"><span class="comment">// 阻塞接收，等待goroutine完成</span></span><br><span class="line">&lt;- done</span><br></pre></td></tr></table></figure>



<h5 id="（6）单向通道"><a href="#（6）单向通道" class="headerlink" title="（6）单向通道"></a>（6）单向通道</h5><p>将通道作为参数在多个任务函数间传递时，限制通道在函数中只能发送或只能接收</p>
<p>单向通道通信方法：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 发送通道 chan &lt;- int 接收通道 &lt;- chan int</span></span><br><span class="line"><span class="comment">// 发送信息到pings通道</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ping</span><span class="params">(pings <span class="keyword">chan</span>&lt;-<span class="keyword">string</span>, msg <span class="keyword">string</span>)</span></span>  &#123;</span><br><span class="line">	pings &lt;- msg</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 接收pings通道的信息， 发送到pongs通道</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">pong</span><span class="params">(pings &lt;-<span class="keyword">chan</span> <span class="keyword">string</span>, pongs <span class="keyword">chan</span>&lt;-<span class="keyword">string</span>)</span></span>  &#123;</span><br><span class="line"></span><br><span class="line">		msg := &lt;-pings</span><br><span class="line">		pongs &lt;- msg</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>单向通道的使用：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 单向信道</span></span><br><span class="line">pings := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">string</span>, <span class="number">1</span>)</span><br><span class="line">pongs := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">string</span>, <span class="number">1</span>)</span><br><span class="line"><span class="comment">// 发送信息到pings通道</span></span><br><span class="line">ping(pings, <span class="string">&quot;passed message&quot;</span>)</span><br><span class="line"><span class="comment">// 接收pings通道的信息， 发送到pongs通道</span></span><br><span class="line">pong(pings, pongs)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 接收pongs信道信息并发送</span></span><br><span class="line">fmt.Println(&lt;-pongs)</span><br></pre></td></tr></table></figure>



<h4 id="3-通道操作"><a href="#3-通道操作" class="headerlink" title="3.通道操作"></a>3.通道操作</h4><h5 id="（1）通道关闭"><a href="#（1）通道关闭" class="headerlink" title="（1）通道关闭"></a>（1）通道关闭</h5><p>通道关闭这个信息也可以被接收到</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Close</span><span class="params">()</span></span>  &#123;</span><br><span class="line"></span><br><span class="line">	jobs := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>, <span class="number">5</span>)</span><br><span class="line">	done := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">bool</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 工作协程接收来自Close协程的信息，当接受完毕后关闭jobs通道</span></span><br><span class="line">	<span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">		<span class="keyword">for</span> &#123;</span><br><span class="line">			<span class="comment">// 接受到more为fasle说明通道被关闭了，发送信息的任务已经结束</span></span><br><span class="line">			j, more := &lt;-jobs</span><br><span class="line">			<span class="keyword">if</span> more &#123;</span><br><span class="line">				fmt.Println(<span class="string">&quot;received job&quot;</span>, j)</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				fmt.Println(<span class="string">&quot;received all jobs&quot;</span>)</span><br><span class="line">				<span class="comment">// 完成全部任务后通知close协程</span></span><br><span class="line">				done &lt;- <span class="literal">true</span></span><br><span class="line">				<span class="keyword">return</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 向jobs通道发送信息</span></span><br><span class="line">	<span class="keyword">for</span> j := <span class="number">1</span>; j &lt;= <span class="number">3</span>; j++&#123;</span><br><span class="line">		jobs &lt;- j</span><br><span class="line">		fmt.Println(<span class="string">&quot;sent job&quot;</span>, j)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 关闭通道</span></span><br><span class="line">	<span class="built_in">close</span>(jobs)</span><br><span class="line">	fmt.Println(<span class="string">&quot;sent all job&quot;</span>)</span><br><span class="line">	<span class="comment">// close协程接收到完成的信号关闭close协程</span></span><br><span class="line">	<span class="comment">// 使得主协程能随工作协程同步结束,可以防止主协程运行完成了,工作协程未完成接收就一起随主协程关闭的情况</span></span><br><span class="line">	&lt;-done</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109081521451.png" alt="image-20210908152110310"></p>
<h5 id="（2）通道数据遍历"><a href="#（2）通道数据遍历" class="headerlink" title="（2）通道数据遍历"></a>（2）通道数据遍历</h5><p>通过range语句也可以遍历通道的数据，但是要先关闭掉通道</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ChannelsRange</span><span class="params">()</span></span>  &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 通道数据遍历</span></span><br><span class="line">	queue := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">string</span>, <span class="number">3</span>)</span><br><span class="line">	queue &lt;- <span class="string">&quot;one&quot;</span></span><br><span class="line">	queue &lt;- <span class="string">&quot;two&quot;</span></span><br><span class="line">	<span class="comment">// 遍历前要先关闭通道(让循环的迭代在2后结束)</span></span><br><span class="line">	<span class="built_in">close</span>(queue)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 通道关闭后仍然可以接收到信息(无法发送信息)</span></span><br><span class="line">	<span class="keyword">for</span> elem := <span class="keyword">range</span> queue&#123;</span><br><span class="line">		fmt.Println(elem)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>







<h4 id="4-select"><a href="#4-select" class="headerlink" title="4.select"></a>4.select</h4><h5 id="（1）同时响应多个通道的操作"><a href="#（1）同时响应多个通道的操作" class="headerlink" title="（1）同时响应多个通道的操作"></a>（1）同时响应多个通道的操作</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">c1 := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">string</span>)</span><br><span class="line">c2 := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">string</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 开启任务1</span></span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">	time.Sleep(<span class="number">1</span> * time.Second)</span><br><span class="line">	c1 &lt;- <span class="string">&quot;one&quot;</span></span><br><span class="line">&#125;()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 开启任务2</span></span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span>&#123;</span><br><span class="line">	time.Sleep(<span class="number">2</span> * time.Second)</span><br><span class="line">	c2 &lt;- <span class="string">&quot;two&quot;</span></span><br><span class="line">&#125;()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用select可以同时响应多个通道的操作，从而实现从多个通道接收数据（本质也是对各个通道扫描）</span></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">2</span>; i++&#123;</span><br><span class="line">	<span class="keyword">select</span> &#123;</span><br><span class="line">		<span class="keyword">case</span> msg1 := &lt;- c1:</span><br><span class="line">			fmt.Println(msg1)</span><br><span class="line"></span><br><span class="line">		<span class="keyword">case</span> msg2 := &lt;- c2:</span><br><span class="line">			fmt.Println(msg2)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109080853240.png" alt="image-20210908085306965"></p>
<h5 id="（2）非阻塞发送接收"><a href="#（2）非阻塞发送接收" class="headerlink" title="（2）非阻塞发送接收"></a>（2）非阻塞发送接收</h5><p>这里所谓的非阻塞是指通过select的default让主线程进入默认分支</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用select实现通道非阻塞发送接收</span></span><br><span class="line">messages := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">string</span>)</span><br><span class="line">signals := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">bool</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 非阻塞接收</span></span><br><span class="line"><span class="keyword">select</span>&#123;</span><br><span class="line">	<span class="comment">// 成功读到数据到msg</span></span><br><span class="line">	<span class="keyword">case</span> msg := &lt;-messages:</span><br><span class="line">		fmt.Println(<span class="string">&quot;received message&quot;</span>, msg)</span><br><span class="line">	<span class="keyword">default</span>:</span><br><span class="line">		fmt.Println(<span class="string">&quot;no message received&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">msg := <span class="string">&quot;hi&quot;</span></span><br><span class="line"><span class="comment">// 非阻塞发送</span></span><br><span class="line"><span class="keyword">select</span>&#123;</span><br><span class="line">	<span class="comment">// 成功发送数据到messages</span></span><br><span class="line">	<span class="keyword">case</span> messages &lt;- msg:</span><br><span class="line">		fmt.Println(<span class="string">&quot;sent message&quot;</span>, msg)</span><br><span class="line">	<span class="keyword">default</span>:</span><br><span class="line">		fmt.Println(<span class="string">&quot;no message sent&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">case</span> msg := &lt;- messages:</span><br><span class="line">		fmt.Println(<span class="string">&quot;received message&quot;</span>, msg)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">case</span> sig := &lt;- signals:</span><br><span class="line">		fmt.Println(<span class="string">&quot;received signal&quot;</span>, sig)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">default</span>:</span><br><span class="line">		fmt.Println(<span class="string">&quot;no activity&quot;</span>)</span><br><span class="line">		&#125;	</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109080905553.png" alt="image-20210908090500412"></p>
<h5 id="（3）超时操作"><a href="#（3）超时操作" class="headerlink" title="（3）超时操作"></a>（3）超时操作</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 超时对于一个需要连接外部资源，或者有耗时较长的操作的程序而言是很重要的</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Timeouts</span><span class="params">()</span></span>  &#123;</span><br><span class="line"></span><br><span class="line">	c1 := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">string</span>, <span class="number">1</span>)</span><br><span class="line">	<span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">		time.Sleep(<span class="number">2</span> * time.Second)</span><br><span class="line">		c1 &lt;- <span class="string">&quot;res 1&quot;</span></span><br><span class="line"></span><br><span class="line">	&#125;()</span><br><span class="line"></span><br><span class="line">	<span class="keyword">select</span> &#123;</span><br><span class="line">		<span class="comment">// 等待结果</span></span><br><span class="line">		<span class="keyword">case</span> res := &lt;- c1:</span><br><span class="line">			fmt.Println(res)</span><br><span class="line">		<span class="comment">// 等待超时后发送的值</span></span><br><span class="line">		<span class="keyword">case</span> &lt;-time.After(<span class="number">1</span> * time.Second):</span><br><span class="line">			fmt.Println(<span class="string">&quot;timeout 1&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="5-定时器"><a href="#5-定时器" class="headerlink" title="5.定时器"></a>5.定时器</h4><h5 id="（1）定时器Timer"><a href="#（1）定时器Timer" class="headerlink" title="（1）定时器Timer"></a>（1）定时器Timer</h5><p>定时器的作用与time.Sleep类似，不同的是time.Sleep硬性规定等待一定时间才能继续进程,而定时器可以在触发前取消掉</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Timer</span><span class="params">()</span></span>  &#123;</span><br><span class="line">	<span class="comment">// 定时器表示在未来某一时刻的独立事件</span></span><br><span class="line">	time1 := time.NewTimer(<span class="number">2</span> * time.Second)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 阻塞直到定时器的通道C发送定时器失效的值</span></span><br><span class="line">	&lt;- time1.C</span><br><span class="line">	fmt.Println(<span class="string">&quot;Timer 1 fired&quot;</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 使用定时器与time.Sleep不同之处在于:</span></span><br><span class="line">	<span class="comment">// time.Sleep硬性规定等待一定时间才能继续进程,而定时器可以在触发前取消掉</span></span><br><span class="line">	time2 := time.NewTimer(time.Second)</span><br><span class="line">	<span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">		&lt;- time2.C</span><br><span class="line">		fmt.Println(<span class="string">&quot;Time 2 fired&quot;</span>)</span><br><span class="line">	&#125;()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 停止定时器</span></span><br><span class="line">	stop2 := time2.Stop()</span><br><span class="line">	<span class="keyword">if</span> stop2 &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;Timer 2 stopped&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	time.Sleep(<span class="number">2</span> * time.Second)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109081529584.png" alt="image-20210908152938454"></p>
<h5 id="（2）打点器Ticker"><a href="#（2）打点器Ticker" class="headerlink" title="（2）打点器Ticker"></a>（2）打点器Ticker</h5><p>定时器用于执行一次时使用,而打点器用于在固定时间间隔重复执行而准备</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Ticker</span><span class="params">()</span></span>  &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 定义打点器</span></span><br><span class="line">	ticker := time.NewTicker(<span class="number">500</span> * time.Millisecond)</span><br><span class="line">	done := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">bool</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">		<span class="comment">// 不断运行,直到从主协程接收到done</span></span><br><span class="line">		<span class="keyword">for</span> &#123;</span><br><span class="line">			<span class="keyword">select</span> &#123;</span><br><span class="line">				<span class="keyword">case</span> &lt;- done:</span><br><span class="line">					<span class="keyword">return</span></span><br><span class="line">				<span class="keyword">case</span> t := &lt;- ticker.C:</span><br><span class="line">					fmt.Println(<span class="string">&quot;Tick at&quot;</span>, t)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 打点器一共运行2000ms,每一次500ms,可以粗略算出运行4次</span></span><br><span class="line">	time.Sleep(<span class="number">2000</span> * time.Millisecond)</span><br><span class="line">	<span class="comment">// 停止打点器并结束子协程</span></span><br><span class="line">	ticker.Stop()</span><br><span class="line">	done &lt;- <span class="literal">true</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;Ticker stopped&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109081532259.png" alt="image-20210908153237860"></p>
<h5 id="（3）速率限制"><a href="#（3）速率限制" class="headerlink" title="（3）速率限制"></a>（3）速率限制</h5><p>速率限制是控制服务资源利用和质量的重要机制。 基于协程、通道和打点器，Go 优雅的支持速率限制</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">RateLimiting</span><span class="params">()</span></span>  &#123;</span><br><span class="line"></span><br><span class="line">	requests := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>, <span class="number">5</span>)</span><br><span class="line">	<span class="keyword">for</span> i:= <span class="number">1</span>; i &lt;= <span class="number">5</span>; i++&#123;</span><br><span class="line">		requests &lt;- i</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">close</span>(requests)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 速率限制调度器设置</span></span><br><span class="line">    <span class="comment">// tick是NewTicker的封装，只提供对Ticker的通道的访问</span></span><br><span class="line">	limiter := time.Tick(<span class="number">200</span> * time.Millisecond)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> req := <span class="keyword">range</span> requests&#123;</span><br><span class="line">		<span class="comment">// 让请求每200ms执行一次</span></span><br><span class="line">		&lt;-limiter</span><br><span class="line">		fmt.Println(<span class="string">&quot;request&quot;</span>, req, time.Now())</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 速率限制方案允许短暂的并发请求，并同时保留总体速率限制</span></span><br><span class="line">	<span class="comment">// 填充通道表示允许的爆发</span></span><br><span class="line">	burstyLimiter := <span class="built_in">make</span>(<span class="keyword">chan</span> time.Time, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 每200ms新的值到burstyLimiter中，直到达到 3 个的限制。</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">3</span>; i++&#123;</span><br><span class="line">		burstyLimiter &lt;- time.Now()</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">		<span class="keyword">for</span> t := <span class="keyword">range</span> time.Tick(<span class="number">200</span> * time.Millisecond)&#123;</span><br><span class="line">			burstyLimiter &lt;- t</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">// 模拟5个传入请求</span></span><br><span class="line">	busstyRequests := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>, <span class="number">5</span>)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= <span class="number">5</span>; i++&#123;</span><br><span class="line">		busstyRequests &lt;- i</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">close</span>(busstyRequests)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 受益于burstyLimiter 的爆发（bursts）能力，前 3 个请求可以快速完成</span></span><br><span class="line">	<span class="keyword">for</span> req := <span class="keyword">range</span> busstyRequests&#123;</span><br><span class="line">		&lt;- burstyLimiter</span><br><span class="line">		fmt.Println(<span class="string">&quot;request&quot;</span>, req, time.Now())</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="6-Goroutine池"><a href="#6-Goroutine池" class="headerlink" title="6.Goroutine池"></a>6.Goroutine池</h4><p>工作池实质上时生产者消费者模型，其可以有效控制gorouine的数量</p>
<p>工作池中有工人（处理工作的协程），有两条流水线（传递工作的通道与传递结果的通道）</p>
<h5 id="（1）创建工作池"><a href="#（1）创建工作池" class="headerlink" title="（1）创建工作池"></a>（1）创建工作池</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 参数：任务编号id，从通道接收工作jobs，发送结果到res通道</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">workers</span><span class="params">(id <span class="keyword">int</span>, jobs &lt;-<span class="keyword">chan</span> <span class="keyword">int</span>, res <span class="keyword">chan</span>&lt;- <span class="keyword">int</span> )</span></span>  &#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> j := <span class="keyword">range</span> jobs&#123;</span><br><span class="line"></span><br><span class="line">			fmt.Println(<span class="string">&quot;worker&quot;</span>, id, <span class="string">&quot;started job&quot;</span>, j)</span><br><span class="line">			time.Sleep(time.Second)</span><br><span class="line">			fmt.Println(<span class="string">&quot;worker&quot;</span>, id, <span class="string">&quot;finnished job&quot;</span>, j)</span><br><span class="line">			res &lt;- j * <span class="number">2</span></span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="（2）使用工作池"><a href="#（2）使用工作池" class="headerlink" title="（2）使用工作池"></a>（2）使用工作池</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">WorkerPools</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">const</span> numJob = <span class="number">5</span></span><br><span class="line">	jobs := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>, numJob)</span><br><span class="line">	results := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>, numJob)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 创建三个worker任务（初始时阻塞的，因为还没有传递任务）</span></span><br><span class="line">	<span class="comment">// 三个workers任务并行执行（即工作池有三位工具人，两条流水线）</span></span><br><span class="line">	<span class="keyword">for</span> w := <span class="number">1</span>; w &lt;= <span class="number">3</span>; w++&#123;</span><br><span class="line">		<span class="keyword">go</span> workers(w, jobs, results)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 发送信息到jobs</span></span><br><span class="line">	<span class="keyword">for</span> j := <span class="number">1</span>; j &lt;= numJob; j++&#123;</span><br><span class="line">		jobs &lt;- j</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// 关闭通道，表示发送完毕</span></span><br><span class="line">	<span class="built_in">close</span>(jobs)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 收集worker的返回值，确保所有worker协程都已经完成</span></span><br><span class="line">	<span class="keyword">for</span> a := <span class="number">1</span>; a &lt;= numJob; a++&#123;</span><br><span class="line">		&lt;-results</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109081546666.png" alt="image-20210908154642399"></p>
<h4 id="7-Sync"><a href="#7-Sync" class="headerlink" title="7.Sync"></a>7.Sync</h4><h5 id="（1）WaitGroup"><a href="#（1）WaitGroup" class="headerlink" title="（1）WaitGroup"></a>（1）WaitGroup</h5><p>在前面的例子中</p>
<ul>
<li>为了同步子协程与主线程我们通过传递done来让主线程等等子协程</li>
<li>为了让主线程等待工作池内的子协程完成任务我们通过收集返回结果来实现同步</li>
<li>这次我们用 sync.WaitGroup来实现并发任务的同步，其内部维护着一个计数器（每个计数器对应一个并发任务）</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// sync.WaitGroup来实现并发任务的同步，其内部维护着一个计数器（每个计数器对应一个并发任务）</span></span><br><span class="line"><span class="comment">// WaitGroup 必须通过指针传递给函数</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">workerA</span><span class="params">(id <span class="keyword">int</span>, wg *sync.WaitGroup)</span></span>  &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 延迟调用wg的Done方法（相当于直到return后才执行），计数器减1（当计数器为0，表明所有的并发任务完成）</span></span><br><span class="line">	<span class="keyword">defer</span> wg.Done()</span><br><span class="line">	fmt.Printf(<span class="string">&quot;Worker %d starting\n&quot;</span>, id)</span><br><span class="line">	time.Sleep(time.Second)</span><br><span class="line">	fmt.Printf(<span class="string">&quot;Worker %d done\n&quot;</span>, id)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">WaitGroup</span><span class="params">()</span></span>  &#123;</span><br><span class="line">	<span class="comment">// WaitGroup 用于等待该函数启动的所有协程</span></span><br><span class="line">	<span class="keyword">var</span> wg sync.WaitGroup</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= <span class="number">5</span>; i++ &#123;</span><br><span class="line">		<span class="comment">// 递增wg计数器</span></span><br><span class="line">		wg.Add(<span class="number">1</span>)</span><br><span class="line">		<span class="comment">// 启动多个协程任务，并传递其wg计数器</span></span><br><span class="line">		<span class="keyword">go</span> workerA(i, &amp;wg)</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 阻塞（主协程）至计数器变为0（所有并发协程已完成）结束</span></span><br><span class="line">	wg.Wait()</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109081630685.png" alt="image-20210908163034514"></p>
<h4 id="8-并发安全"><a href="#8-并发安全" class="headerlink" title="8.并发安全"></a>8.并发安全</h4><p>在工作池中我们使用通道之间的通信管理状态，下面我们使用atomic原子技术和互斥锁技术管理状态保证并发安全</p>
<p>这里以多协程并发访问同一变量作为并发安全问题的案例</p>
<h5 id="（1）互斥锁"><a href="#（1）互斥锁" class="headerlink" title="（1）互斥锁"></a>（1）互斥锁</h5><p>在一个协程操作对资源上锁，其他协程无法访问到该资源，保证了</p>
<p>只有一个协程可以访问共享资源</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Mutexes</span><span class="params">()</span></span>  &#123;</span><br><span class="line">	<span class="comment">// 访问对象</span></span><br><span class="line">	<span class="keyword">var</span> state = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">int</span>]<span class="keyword">int</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// mutex同步对state的访问</span></span><br><span class="line">	<span class="keyword">var</span> mutex = &amp;sync.Mutex&#123;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 追踪读写操作的数量</span></span><br><span class="line">	<span class="keyword">var</span> readOps <span class="keyword">uint64</span></span><br><span class="line">	<span class="keyword">var</span> writeOps <span class="keyword">uint64</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> r := <span class="number">0</span>; r &lt; <span class="number">100</span>; r++&#123;</span><br><span class="line">		<span class="comment">// 启动100个协程做读取操作，每个协程以每 1ms 一次的频率来重复读取 state</span></span><br><span class="line">		<span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">			total := <span class="number">0</span></span><br><span class="line">			<span class="keyword">for</span>&#123;</span><br><span class="line">				<span class="comment">// 生成键对map进行访问（生成在5之间的随机数）</span></span><br><span class="line">				key := rand.Intn(<span class="number">5</span>)</span><br><span class="line">				<span class="comment">// 互斥锁保证该协程对map独占访问</span></span><br><span class="line">				mutex.Lock()</span><br><span class="line">				<span class="comment">// 读取选定键的值</span></span><br><span class="line">				total += state[key]</span><br><span class="line">				<span class="comment">// 解开互斥锁</span></span><br><span class="line">				mutex.Unlock()</span><br><span class="line">				<span class="comment">// 读操作增加1</span></span><br><span class="line">				atomic.AddUint64(&amp;readOps, <span class="number">1</span>)</span><br><span class="line">				time.Sleep(time.Millisecond)</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125;()</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> w := <span class="number">0</span>; w &lt; <span class="number">10</span>; w++&#123;</span><br><span class="line">		<span class="comment">// 启动10个协程模拟写入操作</span></span><br><span class="line">		<span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">			<span class="comment">// 与读取的协程类似</span></span><br><span class="line">			key := rand.Intn(<span class="number">5</span>)</span><br><span class="line">			val := rand.Intn(<span class="number">100</span>)</span><br><span class="line">			mutex.Lock()</span><br><span class="line">			state[key] = val</span><br><span class="line">			mutex.Unlock()</span><br><span class="line">			<span class="comment">// 写操作增加1</span></span><br><span class="line">			atomic.AddUint64(&amp;writeOps, <span class="number">1</span>)</span><br><span class="line">			time.Sleep(time.Millisecond)</span><br><span class="line"></span><br><span class="line">		&#125;()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// 让这 10 个协程对 state 和 mutex 的操作持续 1 s（主进程阻塞）</span></span><br><span class="line">	time.Sleep(time.Second)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 展示最终操作数</span></span><br><span class="line">	readOpsFinal := atomic.LoadUint64(&amp;readOps)</span><br><span class="line">	fmt.Println(<span class="string">&quot;readOps:&quot;</span>, readOpsFinal)</span><br><span class="line">	writeOpsFianl := atomic.LoadUint64(&amp;writeOps)</span><br><span class="line">	fmt.Println(<span class="string">&quot;writeOps:&quot;</span>, writeOpsFianl)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 关闭对state的操作，展示最后结束时的state</span></span><br><span class="line">	mutex.Lock()</span><br><span class="line">	fmt.Println(<span class="string">&quot;state:&quot;</span>, state)</span><br><span class="line">	mutex.Unlock()</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109081711312.png" alt="image-20210908171059061"></p>
<h5 id="（2）atomic（原子操作）"><a href="#（2）atomic（原子操作）" class="headerlink" title="（2）atomic（原子操作）"></a>（2）atomic（原子操作）</h5><p>加锁操作因为涉及内核态的上下文切换会比较耗时、代价比较高。针对基本数据类型我们还可以使用原子操作来保证并发安全</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Atomic</span><span class="params">()</span></span>  &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 设置原子计数器</span></span><br><span class="line">	<span class="keyword">var</span> ops <span class="keyword">uint64</span></span><br><span class="line">	<span class="comment">// 设置非原子计数器</span></span><br><span class="line">	<span class="keyword">var</span> opn <span class="keyword">uint64</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// waitgroup等待协程完成工作</span></span><br><span class="line">	<span class="keyword">var</span> wg sync.WaitGroup</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">50</span>; i++&#123;</span><br><span class="line">		<span class="comment">// 增加协程计数器</span></span><br><span class="line">		wg.Add(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 开启协程进行原子操作</span></span><br><span class="line">		<span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">			<span class="keyword">for</span> c := <span class="number">0</span>; c &lt; <span class="number">1000</span>; c++&#123;</span><br><span class="line">				<span class="comment">// 原子操作增加计数器数值，各协程操作同一数据时之间不会互相干扰</span></span><br><span class="line">				atomic.AddUint64(&amp;ops, <span class="number">1</span>)</span><br><span class="line">				<span class="comment">// 非原子计数，各协程相互干扰</span></span><br><span class="line">				opn++</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">// 增加操作结束后，协程计数器-1</span></span><br><span class="line">			wg.Done()</span><br><span class="line">		&#125;()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 等待直到所有协程完成</span></span><br><span class="line">	wg.Wait()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 安全访问ops（此时无协程写入内容）</span></span><br><span class="line">	<span class="comment">// 此外atomic.LoadUint64 之类的函数，在原子更新的同时安全地读取它们</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;ops&quot;</span>, ops)</span><br><span class="line">	fmt.Println(<span class="string">&quot;opn&quot;</span>, opn)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109081652041.png" alt="image-20210908165217871"></p>
<h5 id="（3）状态协程"><a href="#（3）状态协程" class="headerlink" title="（3）状态协程"></a>（3）状态协程</h5><p>互斥锁中通过锁定让state跨多个go协程同步访问<br>这里我们通过内建协程和通道同步的特性来实现同样的效果<br>通过通信使每个数据仅被单个协程所拥有，即通过通信实现共享内存</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 结构体封装写入与读取的请求</span></span><br><span class="line"><span class="keyword">type</span> readOp <span class="keyword">struct</span> &#123;</span><br><span class="line">	key <span class="keyword">int</span></span><br><span class="line">	resp <span class="keyword">chan</span> <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> writeOp <span class="keyword">struct</span> &#123;</span><br><span class="line">	key <span class="keyword">int</span></span><br><span class="line">	value <span class="keyword">int</span></span><br><span class="line">	resp <span class="keyword">chan</span> <span class="keyword">bool</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">SatefulGoroutines</span><span class="params">()</span></span>  &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> readOps <span class="keyword">uint64</span></span><br><span class="line">	<span class="keyword">var</span> writeOps <span class="keyword">uint64</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// 创建readOp，writeOp类型的通道</span></span><br><span class="line">	<span class="comment">// 其他协程将通过 reads 和 writes 通道来发布 读 和 写 请求</span></span><br><span class="line">	reads := <span class="built_in">make</span>(<span class="keyword">chan</span> readOp)</span><br><span class="line">	writes := <span class="built_in">make</span>(<span class="keyword">chan</span> writeOp)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 拥有state的协程（私有），其可以不断接收读写通道的信息</span></span><br><span class="line">	<span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">		<span class="comment">// state为该协程私有，其他协程（包括主协程都不能访问）</span></span><br><span class="line">		<span class="keyword">var</span> state = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">int</span>]<span class="keyword">int</span>)</span><br><span class="line">		<span class="keyword">for</span> &#123;</span><br><span class="line">			<span class="keyword">select</span>&#123;</span><br><span class="line">				<span class="comment">// 其他协程进行读操作，返回map键对应的值</span></span><br><span class="line">				<span class="keyword">case</span> read := &lt;-reads:</span><br><span class="line">					read.resp &lt;- state[read.key]</span><br><span class="line">				<span class="comment">// 其他协程进行写操作，返回成功</span></span><br><span class="line">				<span class="keyword">case</span> write := &lt;-writes:</span><br><span class="line">					state[write.key] = write.value</span><br><span class="line">					write.resp &lt;- <span class="literal">true</span></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	&#125;()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">// 启动100个协程通过reads通道发起读请求</span></span><br><span class="line">	<span class="keyword">for</span> r := <span class="number">0</span>; r &lt; <span class="number">100</span>; r++&#123;</span><br><span class="line">		<span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">			<span class="keyword">for</span>&#123;</span><br><span class="line">				<span class="comment">// 构造read请求</span></span><br><span class="line">				read := readOp&#123;</span><br><span class="line">					key: rand.Intn(<span class="number">5</span>),</span><br><span class="line">					resp: <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>),</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="comment">// read请求发送reads通道中进行读操作</span></span><br><span class="line">				reads &lt;- read</span><br><span class="line">				<span class="comment">// 通过给定的resp通道接收结果</span></span><br><span class="line">				&lt;- read.resp</span><br><span class="line">				atomic.AddUint64(&amp;readOps, <span class="number">1</span>)</span><br><span class="line">				time.Sleep(time.Millisecond)</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		&#125;()</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 以相同方法启动10个写操作</span></span><br><span class="line">	<span class="keyword">for</span> w := <span class="number">0</span>; w &lt; <span class="number">10</span>; w++&#123;</span><br><span class="line">		<span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">			<span class="keyword">for</span>&#123;</span><br><span class="line">				write := writeOp&#123;</span><br><span class="line">					key: rand.Intn(<span class="number">5</span>),</span><br><span class="line">					value: rand.Intn(<span class="number">100</span>),</span><br><span class="line">					resp: <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">bool</span>),</span><br><span class="line"></span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				writes &lt;- write</span><br><span class="line">				&lt;- write.resp</span><br><span class="line">				atomic.AddUint64(&amp;writeOps, <span class="number">1</span>)</span><br><span class="line">				time.Sleep(time.Millisecond)</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		&#125;()</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 让协程们跑1s（阻塞主协程）</span></span><br><span class="line">	time.Sleep(time.Second)</span><br><span class="line">	readOpsFinal := atomic.LoadUint64(&amp;readOps)</span><br><span class="line">	fmt.Println(<span class="string">&quot;readOps&quot;</span>, readOpsFinal)</span><br><span class="line">	writeOpsFinal := atomic.LoadUint64(&amp;writeOps)</span><br><span class="line">	fmt.Println(<span class="string">&quot;writeOps&quot;</span>, writeOpsFinal)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109081719227.png" alt="image-20210908171921079"></p>
<h3 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h3><h4 id="1-自定义排序"><a href="#1-自定义排序" class="headerlink" title="1.自定义排序"></a>1.自定义排序</h4><p>这里自定义按字符串长度排序</p>
<p>同过实现go提供的sort.Interface接口来实现</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 自定义函数实现自定义排序</span></span><br><span class="line"><span class="keyword">type</span> byLength []<span class="keyword">string</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 实现byLength结构体的对象是实现了sort.Interface接口的所有方法</span></span><br><span class="line"><span class="comment">// 这样我们就可以使用 sort 包的通用 Sort 方法了</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s byLength)</span>  <span class="title">Len</span><span class="params">()</span> <span class="title">int</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">len</span>(s)</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s byLength)</span> <span class="title">Swap</span><span class="params">(i, j <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">	s[i], s[j] = s[j], s[i]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// less方法控制实际的自定义排序逻辑</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s byLength)</span> <span class="title">Less</span><span class="params">(i, j <span class="keyword">int</span>)</span> <span class="title">bool</span></span> &#123;</span><br><span class="line">	<span class="comment">// 按长度排序字符串</span></span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">len</span>(s[i]) &lt; <span class="built_in">len</span>(s[j])</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Sorting</span><span class="params">()</span></span>  &#123;</span><br><span class="line">	asoul := []<span class="keyword">string</span>&#123;<span class="string">&quot;Ava&quot;</span>, <span class="string">&quot;Bella&quot;</span>, <span class="string">&quot;Eileen&quot;</span>,<span class="string">&quot;Carol&quot;</span>, <span class="string">&quot;Diana&quot;</span>&#125;</span><br><span class="line">	<span class="comment">// 将asoul强转换为byLength类型</span></span><br><span class="line">	<span class="comment">// Sort调用实现结构的对象</span></span><br><span class="line">	sort.Sort(byLength(asoul))</span><br><span class="line">	fmt.Println(asoul)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109081723322.png" alt="image-20210908172335154"></p>
<h3 id="JSON"><a href="#JSON" class="headerlink" title="JSON"></a>JSON</h3><h4 id="1-基本概念"><a href="#1-基本概念" class="headerlink" title="1.基本概念"></a>1.基本概念</h4><p>JSON的编码解码即序列化与反序列化</p>
<p>我们常用byte和string作为数据和json表示形式的中介</p>
<p>编码过程：go的其他数据类型 -&gt; byte（字节数组） -&gt; json</p>
<p> 解码过程：json -&gt; byte（字节数组） -&gt; go的其他数据类型（map[string]interface{} / 自定义类型）</p>
<h4 id="2-构造结构体"><a href="#2-构造结构体" class="headerlink" title="2.构造结构体"></a>2.构造结构体</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 构造json类型的结构体</span></span><br><span class="line"><span class="comment">// 必须以大写字母开头的字段才是可导出的。</span></span><br><span class="line"><span class="keyword">type</span> res <span class="keyword">struct</span> &#123;</span><br><span class="line">	Page <span class="keyword">int</span></span><br><span class="line">	Fruits []<span class="keyword">string</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="3-编码"><a href="#3-编码" class="headerlink" title="3.编码"></a>3.编码</h4><p>将Go的数据转换为JSON，go的数据在编码后是byte[]类型，所以要转换成string类型才能打印出字符串</p>
<h5 id="（1）map类型编码"><a href="#（1）map类型编码" class="headerlink" title="（1）map类型编码"></a>（1）map类型编码</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// map类型json编码</span></span><br><span class="line">mapD := <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">int</span>&#123;<span class="string">&quot;apple&quot;</span>:<span class="number">5</span>, <span class="string">&quot;lettuce&quot;</span>:<span class="number">7</span>&#125;</span><br><span class="line">mapB, _ := json.Marshal(mapD)</span><br><span class="line">fmt.Println(<span class="keyword">string</span>(mapB))</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109081736704.png" alt="image-20210908173628386"></p>
<h5 id="（2）自定义类型编码"><a href="#（2）自定义类型编码" class="headerlink" title="（2）自定义类型编码"></a>（2）自定义类型编码</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 结构体实例化</span></span><br><span class="line"><span class="comment">// 结构体实例化赋值时，可以赋予地址也可以赋予值（得到一样的结果）</span></span><br><span class="line"><span class="comment">// 但是赋予地址可以减少系统开销</span></span><br><span class="line">res1D := &amp;res&#123;</span><br><span class="line">	Page: <span class="number">1</span>,</span><br><span class="line">	Fruits: []<span class="keyword">string</span>&#123;<span class="string">&quot;apple&quot;</span>, <span class="string">&quot;peach&quot;</span>, <span class="string">&quot;pear&quot;</span>&#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// json可自动编码自定义类型，编码的输出只有可导出的字段</span></span><br><span class="line">res1B, _ := json.Marshal(res1D)</span><br><span class="line">fmt.Println(<span class="keyword">string</span>(res1B))</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109081734771.png" alt="image-20210908173448648"></p>
<h4 id="4-解码"><a href="#4-解码" class="headerlink" title="4.解码"></a>4.解码</h4><p>将JSON转换为Go语言可以读取的数据类型，</p>
<h5 id="（1）map类型接收"><a href="#（1）map类型接收" class="headerlink" title="（1）map类型接收"></a>（1）map类型接收</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 解码过程</span></span><br><span class="line"><span class="comment">// 构造json</span></span><br><span class="line">byt := []<span class="keyword">byte</span>(<span class="string">`&#123;&quot;num&quot;:6.13, &quot;strs&quot;:[&quot;a&quot;, &quot;b&quot;]&#125;`</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 提供Json包存放解码数据的变量（键为string，值为任意的map）</span></span><br><span class="line"><span class="keyword">var</span> dat <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对数据进行解码</span></span><br><span class="line"><span class="comment">// if语句进行错误检查</span></span><br><span class="line"><span class="keyword">if</span> err := json.Unmarshal(byt, &amp;dat); err != <span class="literal">nil</span>&#123;</span><br><span class="line">	<span class="built_in">panic</span>(err)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 输出解码后的dat</span></span><br><span class="line">fmt.Println(dat)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 为了使用map中的值，我们需要进行恰当的类型转换</span></span><br><span class="line">num := dat[<span class="string">&quot;num&quot;</span>].(<span class="keyword">float64</span>)</span><br><span class="line">fmt.Println(num)</span><br><span class="line"><span class="comment">// 访问嵌套的值</span></span><br><span class="line">strs := dat[<span class="string">&quot;strs&quot;</span>].([]<span class="keyword">interface</span>&#123;&#125;)</span><br><span class="line">str1 := strs[<span class="number">1</span>].(<span class="keyword">string</span>)</span><br><span class="line">fmt.Println(str1)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109081743780.png" alt="image-20210908174316707"></p>
<h5 id="（2）自定义数据类型接收"><a href="#（2）自定义数据类型接收" class="headerlink" title="（2）自定义数据类型接收"></a>（2）自定义数据类型接收</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 将json解码为自定义数据类型（增加类型安全性）,推荐的解码方式</span></span><br><span class="line"><span class="comment">// ``可以定义字符串，且其内可以有双引号&quot;&quot;</span></span><br><span class="line">str := <span class="string">`&#123;&quot;page&quot;: 1, &quot;fruits&quot;: [&quot;apple&quot;, &quot;peach&quot;]&#125;`</span></span><br><span class="line">fmt.Println(reflect.TypeOf(str))</span><br><span class="line"></span><br><span class="line">res := res&#123;&#125;</span><br><span class="line"><span class="comment">// 将str转换为byte数组类型，后将其解码放在res类型的结构体中</span></span><br><span class="line">json.Unmarshal([]<span class="keyword">byte</span>(str), &amp;res)</span><br><span class="line">fmt.Println(res)</span><br><span class="line">fmt.Println(res.Fruits[<span class="number">0</span>])</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109081744858.png" alt="image-20210908174428706"></p>
<h5 id="（3）Encode接收"><a href="#（3）Encode接收" class="headerlink" title="（3）Encode接收"></a>（3）Encode接收</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 我们还可以将os.Stdout 一样直接将 JSON 编码流传输到 os.Writer 甚至 HTTP 响应体</span></span><br><span class="line"><span class="comment">// 创建一个将数据写入*Encoder（可以接收信息）</span></span><br><span class="line">enc := json.NewEncoder(os.Stdout)</span><br><span class="line">d := <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">int</span>&#123;<span class="string">&quot;apple&quot;</span>: <span class="number">5</span>, <span class="string">&quot;lettuce&quot;</span>: <span class="number">7</span>&#125;</span><br><span class="line"><span class="comment">// 将json编码写入输出流输出</span></span><br><span class="line">enc.Encode(d)</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109081745019.png" alt="image-20210908174505894"></p>
<h3 id="单元测试"><a href="#单元测试" class="headerlink" title="单元测试"></a>单元测试</h3><h4 id="1-单元测试命名规则"><a href="#1-单元测试命名规则" class="headerlink" title="1.单元测试命名规则"></a>1.单元测试命名规则</h4><ul>
<li>文件名必须以xx_test.go命名</li>
<li>方法必须是Test开头</li>
<li>方法参数必须 t *testing.T</li>
<li>测试例与被测试对象要放在一个包中</li>
<li>使用go test执行单元测试（idea可以直接运行测试例）</li>
</ul>
<h4 id="2-被测对象"><a href="#2-被测对象" class="headerlink" title="2.被测对象"></a>2.被测对象</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// IntMin 主程序</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">IntMin</span><span class="params">(a, b <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">	<span class="keyword">if</span> a &lt; b&#123;</span><br><span class="line">		<span class="keyword">return</span> a</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> b</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="3-一般测试例"><a href="#3-一般测试例" class="headerlink" title="3.一般测试例"></a>3.一般测试例</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// TestIntMinBasic 测试程序</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestIntMinBasic</span><span class="params">(t *testing.T)</span></span>  &#123;</span><br><span class="line"></span><br><span class="line">	ans := IntMin(<span class="number">2</span>, <span class="number">-2</span>)</span><br><span class="line">	<span class="keyword">if</span> ans != <span class="number">-2</span>&#123;</span><br><span class="line">		<span class="comment">// t.Error*会报告测试失败的信息，然后立即终止测试</span></span><br><span class="line">		<span class="comment">// t.Fail*会报告测试失败的信息，然后立即终止测试</span></span><br><span class="line">		t.Errorf(<span class="string">&quot;IntMin(2, -2) = %d; want -2&quot;</span>, ans)</span><br><span class="line">	&#125; <span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line">		fmt.Println(ans)</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h4 id="4-表驱动测试例"><a href="#4-表驱动测试例" class="headerlink" title="4.表驱动测试例"></a>4.表驱动测试例</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// TestIntMinTableDriven 单元测试可以重复，所以会经常使用表驱动风格编写单元测试</span></span><br><span class="line"><span class="comment">// 表中列出了输入数据，预期输出，使用循环，遍历并执行测试逻辑</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestIntMinTableDriven</span><span class="params">(t *testing.T)</span></span>  &#123;</span><br><span class="line">	<span class="keyword">var</span> tests = []<span class="keyword">struct</span> &#123;</span><br><span class="line">		a, b <span class="keyword">int</span></span><br><span class="line">		want <span class="keyword">int</span></span><br><span class="line">	&#125;&#123;</span><br><span class="line">		&#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>&#125;,</span><br><span class="line">		&#123;<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>&#125;,</span><br><span class="line">		&#123;<span class="number">2</span>, <span class="number">-2</span>, <span class="number">-2</span>&#125;,</span><br><span class="line">		&#123;<span class="number">0</span>, <span class="number">-1</span>, <span class="number">-1</span>&#125;,</span><br><span class="line">		&#123;<span class="number">-1</span>, <span class="number">0</span>, <span class="number">-1</span>&#125;,</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> _, tt := <span class="keyword">range</span> tests &#123;</span><br><span class="line"></span><br><span class="line">		testname := fmt.Sprintf(<span class="string">&quot;%d, %d&quot;</span>, tt.a, tt.b)</span><br><span class="line">		<span class="comment">// t.Run运行一个子测试，每一个子测试对应表中一行数据</span></span><br><span class="line">		t.Run(testname, <span class="function"><span class="keyword">func</span><span class="params">(t *testing.T)</span></span>&#123;</span><br><span class="line">			ans := IntMin(tt.a, tt.b)</span><br><span class="line">			<span class="keyword">if</span> ans != tt.want&#123;</span><br><span class="line">				t.Errorf(<span class="string">&quot;got %d, want %d&quot;</span>, ans, tt.want)</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125;)</span><br><span class="line"></span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>



<h3 id="HTTP客户端"><a href="#HTTP客户端" class="headerlink" title="HTTP客户端"></a>HTTP客户端</h3><h4 id="1-GET请求"><a href="#1-GET请求" class="headerlink" title="1.GET请求"></a>1.GET请求</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// go向服务端发送GET请求</span></span><br><span class="line"></span><br><span class="line">resp1, err := http.Get(<span class="string">&quot;https://search.bilibili.com/&quot;</span>)</span><br><span class="line"><span class="comment">// 捕捉错误</span></span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span>&#123;</span><br><span class="line">	<span class="built_in">panic</span>(err)</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 延迟关闭请求服务</span></span><br><span class="line"><span class="keyword">defer</span> resp1.Body.Close()</span><br><span class="line"></span><br><span class="line">fmt.Println(resp1)</span><br><span class="line"><span class="comment">// 打印返回的请求状态</span></span><br><span class="line">fmt.Println(<span class="string">&quot;Response status&quot;</span>, resp1.Status)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 打印响应的内容</span></span><br><span class="line"><span class="comment">// 使用ioutil读取数据（读取返回的是字节数组）</span></span><br><span class="line">body, err := ioutil.ReadAll(resp1.Body)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">	fmt.Println(err)</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">fmt.Println(<span class="keyword">string</span>(body))</span><br></pre></td></tr></table></figure>



<h4 id="2-带参数GET请求"><a href="#2-带参数GET请求" class="headerlink" title="2.带参数GET请求"></a>2.带参数GET请求</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// go向服务端发送带参数GET请求</span></span><br><span class="line">apiurl := <span class="string">&quot;https://search.bilibili.com/all&quot;</span></span><br><span class="line"><span class="comment">// 构造get请求表单</span></span><br><span class="line">data := url.Values&#123;&#125;</span><br><span class="line">data.Set(<span class="string">&quot;keyword&quot;</span>, <span class="string">&quot;Autovy&quot;</span>)</span><br><span class="line">data.Set(<span class="string">&quot;from_source&quot;</span>, <span class="string">&quot;webtop_search&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 结合参数构造请求结构体</span></span><br><span class="line">u, err := url.ParseRequestURI(apiurl)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">	fmt.Println(err)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// url编码</span></span><br><span class="line">u.RawQuery = data.Encode()</span><br><span class="line"><span class="comment">// 生成带参数url</span></span><br><span class="line">fmt.Println(u.String())</span><br><span class="line"></span><br><span class="line"><span class="comment">// 进行http请求（下面的步骤与一般的get请求一致）</span></span><br><span class="line"><span class="comment">// 其实也可以把带参数的url直接进行请求😅</span></span><br><span class="line">resp2, err := http.Get(u.String())</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;post failed, err:%v\n&quot;</span>, err)</span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">defer</span> resp2.Body.Close()</span><br><span class="line"></span><br><span class="line">b, err := ioutil.ReadAll(resp2.Body)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;get resp failed,err:%v\n&quot;</span>, err)</span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">fmt.Println(<span class="keyword">string</span>(b))</span><br></pre></td></tr></table></figure>



<h4 id="3-POST请求"><a href="#3-POST请求" class="headerlink" title="3.POST请求"></a>3.POST请求</h4><h5 id="（1）发送from-data"><a href="#（1）发送from-data" class="headerlink" title="（1）发送from-data"></a>（1）发送from-data</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 构造表单</span></span><br><span class="line">data2 := url.Values&#123;</span><br><span class="line">	<span class="string">&quot;name&quot;</span>:       &#123;<span class="string">&quot;Autovy&quot;</span>&#125;,</span><br><span class="line">	<span class="string">&quot;occupation&quot;</span>: &#123;<span class="string">&quot;programmar&quot;</span>&#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 发送表单</span></span><br><span class="line">resp, err := http.PostForm(<span class="string">&quot;https://httpbin.org/post&quot;</span>, data2)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 捕捉异常</span></span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">	<span class="built_in">panic</span>(err)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 解码返回的信息</span></span><br><span class="line"><span class="keyword">var</span> res <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">json.NewDecoder(resp.Body).Decode(&amp;res)</span><br><span class="line">fmt.Println(res[<span class="string">&quot;form&quot;</span>])</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109082013606.png" alt="image-20210908201313448"></p>
<h5 id="（2）发送json"><a href="#（2）发送json" class="headerlink" title="（2）发送json"></a>（2）发送json</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 构造json数据</span></span><br><span class="line">values := <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>&#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;Ava&quot;</span>, <span class="string">&quot;occupation&quot;</span>: <span class="string">&quot;Gamer&quot;</span>&#125;</span><br><span class="line">json_data, err := json.Marshal(values)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">	<span class="built_in">panic</span>(err)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// post发送json数据</span></span><br><span class="line">resp3, err := http.Post(<span class="string">&quot;https://httpbin.org/post&quot;</span>, <span class="string">&quot;application/json&quot;</span>, bytes.NewBuffer(json_data))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">	<span class="built_in">panic</span>(err)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 解码返回信息</span></span><br><span class="line"><span class="keyword">var</span> res2 <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">json.NewDecoder(resp3.Body).Decode(&amp;res2)</span><br><span class="line">fmt.Println(res2[<span class="string">&quot;json&quot;</span>])</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109082013186.png" alt="image-20210908201329065"></p>
<h3 id="HTTP服务端"><a href="#HTTP服务端" class="headerlink" title="HTTP服务端"></a>HTTP服务端</h3><p>服务端构造处理请求的函数handler</p>
<p>handler 函数有两个参数，http.ResponseWriter 和 http.Request</p>
<h4 id="1-普通服务"><a href="#1-普通服务" class="headerlink" title="1.普通服务"></a>1.普通服务</h4><h5 id="（1）处理http请求"><a href="#（1）处理http请求" class="headerlink" title="（1）处理http请求"></a>（1）处理http请求</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  我们需要读取的 HTTP 请求 header 中的所有内容，并将他们输出至 response body</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">headers</span><span class="params">(w http.ResponseWriter, req *http.Request)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> name, headers := <span class="keyword">range</span> req.Header &#123;</span><br><span class="line">		<span class="keyword">for</span> _, h := <span class="keyword">range</span> headers &#123;</span><br><span class="line">			fmt.Fprintf(w, <span class="string">&quot;%v: %v\n&quot;</span>, name, h)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="（2）函数注册到路由"><a href="#（2）函数注册到路由" class="headerlink" title="（2）函数注册到路由"></a>（2）函数注册到路由</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http.HandleFunc(<span class="string">&quot;/headers&quot;</span>, headers)</span><br><span class="line"></span><br><span class="line"><span class="comment">//我们调用 ListenAndServe 并带上端口和 handler。nil表示使用我们刚刚设置的默认路由器</span></span><br><span class="line">http.ListenAndServe(<span class="string">&quot;:8090&quot;</span>, <span class="literal">nil</span>)</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109081934116.png" alt="image-20210908193457887"></p>
<h4 id="2-接受GET请求参数"><a href="#2-接受GET请求参数" class="headerlink" title="2.接受GET请求参数"></a>2.接受GET请求参数</h4><h5 id="（1）处理get请求"><a href="#（1）处理get请求" class="headerlink" title="（1）处理get请求"></a>（1）处理get请求</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 处理带参数的get请求</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getHandler</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span>  &#123;</span><br><span class="line">	<span class="comment">// 延迟关闭响应</span></span><br><span class="line">	<span class="keyword">defer</span> r.Body.Close()</span><br><span class="line">	<span class="comment">// 接受url的参数</span></span><br><span class="line">	data := r.URL.Query()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 输出内容到页面</span></span><br><span class="line">	answer := <span class="string">`&#123;&quot;status&quot; : &quot;ok&quot;&#125;`</span></span><br><span class="line">	w.Write([]<span class="keyword">byte</span>(answer))</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 获取请求链接中的参数</span></span><br><span class="line">	fmt.Fprintln( w ,data.Get(<span class="string">&quot;name&quot;</span>))</span><br><span class="line">	fmt.Fprintln( w ,data.Get(<span class="string">&quot;age&quot;</span>))</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="（2）函数注册到路由-1"><a href="#（2）函数注册到路由-1" class="headerlink" title="（2）函数注册到路由"></a>（2）函数注册到路由</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http.HandleFunc(<span class="string">&quot;/get&quot;</span>, getHandler)</span><br><span class="line"></span><br><span class="line"><span class="comment">//我们调用 ListenAndServe 并带上端口和 handler。nil表示使用我们刚刚设置的默认路由器</span></span><br><span class="line">http.ListenAndServe(<span class="string">&quot;:8090&quot;</span>, <span class="literal">nil</span>)</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109081941217.png" alt="image-20210908194148189"></p>
<h4 id="3-接受POST请求参数"><a href="#3-接受POST请求参数" class="headerlink" title="3.接受POST请求参数"></a>3.接受POST请求参数</h4><h5 id="（1）处理post请求函数"><a href="#（1）处理post请求函数" class="headerlink" title="（1）处理post请求函数"></a>（1）处理post请求函数</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// post请求</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">postHandler</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span>  &#123;</span><br><span class="line">	<span class="keyword">defer</span> r.Body.Close()</span><br><span class="line">	<span class="comment">// 请求类型为application/x-www-form-urlencoded时解析form数据</span></span><br><span class="line">	r.ParseForm()</span><br><span class="line">	<span class="comment">// 打印form数据</span></span><br><span class="line">	fmt.Println(r.PostForm)</span><br><span class="line">	fmt.Println(r.PostForm.Get(<span class="string">&quot;name&quot;</span>), r.PostForm.Get(<span class="string">&quot;age&quot;</span>))</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 2. 请求类型是application/json时从r.Body读取数据</span></span><br><span class="line">	b, err := ioutil.ReadAll(r.Body)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	fmt.Fprintln(w, <span class="keyword">string</span>(b))</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="（2）函数注册到路由-2"><a href="#（2）函数注册到路由-2" class="headerlink" title="（2）函数注册到路由"></a>（2）函数注册到路由</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http.HandleFunc(<span class="string">&quot;/post&quot;</span>, postHandler)</span><br><span class="line"></span><br><span class="line"><span class="comment">//我们调用 ListenAndServe 并带上端口和 handler。nil表示使用我们刚刚设置的默认路由器</span></span><br><span class="line">http.ListenAndServe(<span class="string">&quot;:8090&quot;</span>, <span class="literal">nil</span>)</span><br></pre></td></tr></table></figure>



<h5 id="（3）请求类型为application-x-www-form-urlencoded"><a href="#（3）请求类型为application-x-www-form-urlencoded" class="headerlink" title="（3）请求类型为application/x-www-form-urlencoded"></a>（3）请求类型为application/x-www-form-urlencoded</h5><p><img src="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109070739852.png" alt="image-20210907073940923"></p>
<p>运行结果：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109070740152.png" alt="image-20210907074031817"></p>
<h5 id="（3）请求类型为application-json"><a href="#（3）请求类型为application-json" class="headerlink" title="（3）请求类型为application/json"></a>（3）请求类型为application/json</h5><p>服务端可以进行反序列化操作得到json内的数据</p>
<p><img src="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109070744119.png" alt="image-20210907074448963"></p>
<h3 id="结束"><a href="#结束" class="headerlink" title="结束"></a>结束</h3><p><img src="https://cdn.jsdelivr.net/gh/Autovy/Image/img/202109082024169.jpg" alt="cute"></p>
<p>快乐生活，快乐工作，快乐学习</p>
<p><code>os.Exit(1)</code></p>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>Autovy
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://autovy.github.io/2021/09/08/Go/Go%E8%AF%AD%E8%A8%80%E4%BF%AE%E7%82%BC%E6%89%8B%E5%86%8C/" title="Go|Go语言修炼手册">https://autovy.github.io/2021/09/08/Go/Go语言修炼手册/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/" rel="tag"><i class="fa fa-tag"></i> 入门教程</a>
              <a href="/tags/%E5%90%8E%E7%AB%AF/" rel="tag"><i class="fa fa-tag"></i> 后端</a>
              <a href="/tags/Go/" rel="tag"><i class="fa fa-tag"></i> Go</a>
              <a href="/tags/%E9%9D%A2%E5%90%91%E6%8E%A5%E5%8F%A3/" rel="tag"><i class="fa fa-tag"></i> 面向接口</a>
              <a href="/tags/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/" rel="tag"><i class="fa fa-tag"></i> 并发编程</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/07/15/PHP/PHP-%E8%AF%BE%E9%A2%98%E7%94%B3%E6%8A%A5%E7%B3%BB%E7%BB%9F%E5%BC%80%E5%8F%91(Vue+TP)/" rel="prev" title="PHP|课题申报系统开发(Vue+TP)">
      <i class="fa fa-chevron-left"></i> PHP|课题申报系统开发(Vue+TP)
    </a></div>
      <div class="post-nav-item">
    <a href="/2021/09/14/Java/Java-JavaWeb%E5%85%A5%E9%97%A8%E8%AE%B2%E8%A7%A3/" rel="next" title="Java|JavaWeb入门讲解">
      Java|JavaWeb入门讲解 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>



  
  
  

  </div>


          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#HelloGo"><span class="nav-text">HelloGo</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-Golang%E7%9A%84%E4%B8%BB%E8%A6%81%E7%89%B9%E5%BE%81"><span class="nav-text">1.Golang的主要特征</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E7%AC%AC%E4%B8%80%E4%B8%AAGo%E7%A8%8B%E5%BA%8F"><span class="nav-text">2.第一个Go程序</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-Go%E7%9A%84%E5%80%BC%E8%BF%90%E7%AE%97"><span class="nav-text">3.Go的值运算</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%98%E9%87%8F%E4%B8%8E%E5%B8%B8%E9%87%8F"><span class="nav-text">变量与常量</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E5%8F%98%E9%87%8F"><span class="nav-text">1.变量</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%881%EF%BC%89%E6%A0%87%E5%87%86%E5%A3%B0%E6%98%8E"><span class="nav-text">（1）标准声明</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%882%EF%BC%89%E6%89%B9%E9%87%8F%E5%A3%B0%E6%98%8E"><span class="nav-text">（2）批量声明</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%883%EF%BC%89%E7%9F%AD%E5%8F%98%E9%87%8F%E5%A3%B0%E6%98%8E"><span class="nav-text">（3）短变量声明</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E5%B8%B8%E9%87%8F"><span class="nav-text">2.常量</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="nav-text">基本数据结构</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E6%95%B0%E7%BB%84Array"><span class="nav-text">1.数组Array</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%881%EF%BC%89%E5%A3%B0%E6%98%8E%E9%BB%98%E8%AE%A4%E6%95%B0%E7%BB%84"><span class="nav-text">（1）声明默认数组</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%882%EF%BC%89%E5%A3%B0%E6%98%8E%E5%B9%B6%E5%88%9D%E5%A7%8B%E5%8C%96%E6%95%B0%E7%BB%84"><span class="nav-text">（2）声明并初始化数组</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%883%EF%BC%89%E5%A3%B0%E6%98%8E%E4%BA%8C%E7%BB%B4%E6%95%B0%E7%BB%84"><span class="nav-text">（3）声明二维数组</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E5%88%87%E7%89%87Slice"><span class="nav-text">2.切片Slice</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%881%EF%BC%89%E5%88%87%E7%89%87%E7%AE%80%E4%BB%8B"><span class="nav-text">（1）切片简介</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%882%EF%BC%89%E5%88%87%E7%89%87%E4%B8%80%E8%88%AC%E5%A3%B0%E6%98%8E"><span class="nav-text">（2）切片一般声明</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%883%EF%BC%89make%E5%88%9B%E5%BB%BA"><span class="nav-text">（3）make创建</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%884%EF%BC%89%E5%88%87%E7%89%87%E8%B5%8B%E5%80%BC%E4%B8%8E%E8%BF%BD%E5%8A%A0"><span class="nav-text">（4）切片赋值与追加</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%885%EF%BC%89%E5%88%87%E7%89%87%E5%A4%8D%E5%88%B6"><span class="nav-text">（5）切片复制</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%886%EF%BC%89%E7%94%B1%E6%95%B0%E7%BB%84%E6%88%96%E5%88%87%E7%89%87%E8%8E%B7%E5%BE%97%E5%88%87%E7%89%87"><span class="nav-text">（6）由数组或切片获得切片</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-Map"><span class="nav-text">3.Map</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%881%EF%BC%89map%E7%9A%84%E5%88%9B%E5%BB%BA"><span class="nav-text">（1）map的创建</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%882%EF%BC%89map%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="nav-text">（2）map初始化</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%883%EF%BC%89map%E8%B5%8B%E5%80%BC%E4%B8%8E%E5%8F%96%E5%80%BC"><span class="nav-text">（3）map赋值与取值</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%884%EF%BC%89map%E5%88%A0%E9%99%A4%E6%93%8D%E4%BD%9C"><span class="nav-text">（4）map删除操作</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6"><span class="nav-text">基本流程控制</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-if%E8%AF%AD%E5%8F%A5"><span class="nav-text">1.if语句</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-switch%E8%AF%AD%E5%8F%A5"><span class="nav-text">2.switch语句</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%881%EF%BC%89%E4%BD%BF%E7%94%A8%E5%8F%98%E9%87%8F%E4%BD%9C%E4%B8%BA%E5%88%A4%E5%AE%9A%E6%9D%A1%E4%BB%B6"><span class="nav-text">（1）使用变量作为判定条件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%882%EF%BC%89%E4%BD%BF%E7%94%A8%E5%87%BD%E6%95%B0%E8%BF%94%E5%9B%9E%E7%9A%84%E5%8F%98%E9%87%8F%E5%80%BC%E4%BD%9C%E4%B8%BAexpression"><span class="nav-text">（2）使用函数返回的变量值作为expression</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%883%EF%BC%89%E4%BD%BF%E7%94%A8%E5%87%BD%E6%95%B0%E8%BF%94%E5%9B%9E%E5%80%BC%E7%9A%84%E5%8F%98%E9%87%8F%E4%BD%9C%E4%B8%BAconstant-expression"><span class="nav-text">（3）使用函数返回值的变量作为constant-expression</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-for%E8%AF%AD%E5%8F%A5"><span class="nav-text">3.for语句</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-Range%E8%AF%AD%E5%8F%A5"><span class="nav-text">4.Range语句</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%881%EF%BC%89Range%E7%AE%80%E4%BB%8B"><span class="nav-text">（1）Range简介</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%882%EF%BC%89%E6%95%B0%E7%BB%84%E9%81%8D%E5%8E%86"><span class="nav-text">（2）数组遍历</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%883%EF%BC%89map%E9%81%8D%E5%8E%86"><span class="nav-text">（3）map遍历</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%87%BD%E6%95%B0"><span class="nav-text">函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E5%A4%9A%E5%8F%82%E6%95%B0"><span class="nav-text">1.多参数</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%881%EF%BC%89%E4%B8%A4%E5%8F%82%E6%95%B0"><span class="nav-text">（1）两参数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%882%EF%BC%89%E5%90%8C%E7%B1%BB%E5%9E%8B%E5%A4%9A%E5%8F%82%E6%95%B0"><span class="nav-text">（2）同类型多参数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%883%EF%BC%89%E5%8F%AF%E5%8F%98%E5%8F%82%E6%95%B0"><span class="nav-text">（3）可变参数</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E5%A4%9A%E8%BF%94%E5%9B%9E%E5%80%BC"><span class="nav-text">2.多返回值</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E9%97%AD%E5%8C%85%E5%87%BD%E6%95%B0"><span class="nav-text">3.闭包函数</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%881%EF%BC%89%E5%A3%B0%E6%98%8E"><span class="nav-text">（1）声明</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%882%EF%BC%89%E8%B0%83%E7%94%A8"><span class="nav-text">（2）调用</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%883%EF%BC%89%E7%BB%93%E6%9E%9C"><span class="nav-text">（3）结果</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-%E9%80%92%E5%BD%92%E5%87%BD%E6%95%B0"><span class="nav-text">4.递归函数</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8C%87%E9%92%88"><span class="nav-text">指针</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E5%87%BD%E6%95%B0%E4%B8%AD%E7%9A%84%E6%8C%87%E9%92%88%E5%8F%82%E6%95%B0"><span class="nav-text">1.函数中的指针参数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E8%B0%83%E7%94%A8%E4%B8%8E%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C"><span class="nav-text">2.调用与运行结果</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%93%E6%9E%84%E4%BD%93"><span class="nav-text">结构体</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E7%BB%93%E6%9E%84%E4%BD%93%E7%AE%80%E4%BB%8B"><span class="nav-text">1.结构体简介</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E7%BB%93%E6%9E%84%E4%BD%93%E5%AE%9E%E4%BE%8B%E5%8C%96"><span class="nav-text">2.结构体实例化</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%881%EF%BC%89%E5%A3%B0%E6%98%8E%E7%BB%93%E6%9E%84%E4%BD%93"><span class="nav-text">（1）声明结构体</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%882%EF%BC%89%E7%BB%93%E6%9E%84%E4%BD%93%E5%AE%9E%E4%BE%8B%E5%8C%96"><span class="nav-text">（2）结构体实例化</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%883%EF%BC%89%E7%BB%93%E6%9E%84%E4%BD%93%E5%9C%B0%E5%9D%80"><span class="nav-text">（3）结构体地址</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0"><span class="nav-text">3.构造函数</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%881%EF%BC%89%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95"><span class="nav-text">（1）构造方法</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%882%EF%BC%89%E8%B0%83%E7%94%A8%E4%B8%8E%E7%BB%93%E6%9E%9C"><span class="nav-text">（2）调用与结果</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-%E7%BB%93%E6%9E%84%E4%BD%93%E6%96%B9%E6%B3%95"><span class="nav-text">4.结构体方法</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%881%EF%BC%89%E5%AE%9A%E4%B9%89%E7%BB%93%E6%9E%84%E4%BD%93"><span class="nav-text">（1）定义结构体</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%882%EF%BC%89%E6%8C%87%E9%92%88%E6%8E%A5%E6%94%B6%E7%B1%BB%E5%9E%8B%E6%96%B9%E6%B3%95"><span class="nav-text">（2）指针接收类型方法</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%883%EF%BC%89%E5%80%BC%E6%8E%A5%E6%94%B6%E7%B1%BB%E5%9E%8B%E6%96%B9%E6%B3%95"><span class="nav-text">（3）值接收类型方法</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8E%A5%E5%8F%A3"><span class="nav-text">接口</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E6%8E%A5%E5%8F%A3%E7%AE%80%E4%BB%8B"><span class="nav-text">1.接口简介</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E6%8E%A5%E5%8F%A3%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="nav-text">2.接口的实现</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%881%EF%BC%89%E5%AE%9A%E4%B9%89%E6%8E%A5%E5%8F%A3"><span class="nav-text">（1）定义接口</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%882%EF%BC%89%E6%9E%84%E5%BB%BA%E7%BB%93%E6%9E%84%E4%BD%93%EF%BC%88%E7%94%A8%E4%BA%8E%E7%94%9F%E6%88%90%E5%AF%B9%E8%B1%A1%EF%BC%89"><span class="nav-text">（2）构建结构体（用于生成对象）</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%883%EF%BC%89%E7%BB%93%E6%9E%84%E4%BD%93%E7%9A%84%E6%96%B9%E6%B3%95%E5%AE%9E%E7%8E%B0%E6%8E%A5%E5%8F%A3"><span class="nav-text">（3）结构体的方法实现接口</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%884%EF%BC%89-%E7%BB%93%E6%9E%84%E4%BD%93%E5%AE%9E%E4%BE%8B%E5%8C%96%E7%94%9F%E6%88%90%E5%AF%B9%E8%B1%A1"><span class="nav-text">（4） 结构体实例化生成对象</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86"><span class="nav-text">异常处理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E5%86%85%E7%BD%AE%E6%8E%A5%E5%8F%A3%E8%BF%94%E5%9B%9E%E9%94%99%E8%AF%AF%E4%BF%A1%E6%81%AF"><span class="nav-text">1.内置接口返回错误信息</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BB%93%E6%9E%84%E4%BD%93"><span class="nav-text">2.自定义结构体</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%881%EF%BC%89%E5%AE%9A%E4%B9%89%E7%BB%93%E6%9E%84%E4%BD%93-1"><span class="nav-text">（1）定义结构体</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%882%EF%BC%89%E5%AE%9A%E4%B9%89%E7%BB%93%E6%9E%84%E4%BD%93%E6%96%B9%E6%B3%95"><span class="nav-text">（2）定义结构体方法</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%883%EF%BC%89%E5%BC%82%E5%B8%B8%E6%B5%8B%E8%AF%95%E6%96%B9%E6%B3%95"><span class="nav-text">（3）异常测试方法</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%884%EF%BC%89%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B"><span class="nav-text">（4）测试用例</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B"><span class="nav-text">并发编程</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-Goroutines%EF%BC%88%E5%8D%8F%E7%A8%8B%EF%BC%89"><span class="nav-text">1.Goroutines（协程）</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%881%EF%BC%89%E5%8D%8F%E7%A8%8B%E7%AE%80%E4%BB%8B"><span class="nav-text">（1）协程简介</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%882%EF%BC%89%E8%BF%90%E8%A1%8C%E6%A1%88%E4%BE%8B"><span class="nav-text">（2）运行案例</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-Channels%EF%BC%88%E9%80%9A%E9%81%93%EF%BC%89"><span class="nav-text">2.Channels（通道）</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%881%EF%BC%89%E9%80%9A%E9%81%93%E7%AE%80%E4%BB%8B"><span class="nav-text">（1）通道简介</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%882%EF%BC%89%E9%80%9A%E9%81%93%E7%9A%84%E5%8F%91%E9%80%81%E4%B8%8E%E6%8E%A5%E6%94%B6"><span class="nav-text">（2）通道的发送与接收</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%883%EF%BC%89%E6%97%A0%E7%BC%93%E5%86%B2%E9%80%9A%E9%81%93"><span class="nav-text">（3）无缓冲通道</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%884%EF%BC%89%E6%9C%89%E7%BC%93%E5%86%B2%E9%80%9A%E9%81%93"><span class="nav-text">（4）有缓冲通道</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%885%EF%BC%89%E4%BF%A1%E9%81%93%E5%90%8C%E6%AD%A5"><span class="nav-text">（5）信道同步</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%886%EF%BC%89%E5%8D%95%E5%90%91%E9%80%9A%E9%81%93"><span class="nav-text">（6）单向通道</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E9%80%9A%E9%81%93%E6%93%8D%E4%BD%9C"><span class="nav-text">3.通道操作</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%881%EF%BC%89%E9%80%9A%E9%81%93%E5%85%B3%E9%97%AD"><span class="nav-text">（1）通道关闭</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%882%EF%BC%89%E9%80%9A%E9%81%93%E6%95%B0%E6%8D%AE%E9%81%8D%E5%8E%86"><span class="nav-text">（2）通道数据遍历</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-select"><span class="nav-text">4.select</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%881%EF%BC%89%E5%90%8C%E6%97%B6%E5%93%8D%E5%BA%94%E5%A4%9A%E4%B8%AA%E9%80%9A%E9%81%93%E7%9A%84%E6%93%8D%E4%BD%9C"><span class="nav-text">（1）同时响应多个通道的操作</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%882%EF%BC%89%E9%9D%9E%E9%98%BB%E5%A1%9E%E5%8F%91%E9%80%81%E6%8E%A5%E6%94%B6"><span class="nav-text">（2）非阻塞发送接收</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%883%EF%BC%89%E8%B6%85%E6%97%B6%E6%93%8D%E4%BD%9C"><span class="nav-text">（3）超时操作</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-%E5%AE%9A%E6%97%B6%E5%99%A8"><span class="nav-text">5.定时器</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%881%EF%BC%89%E5%AE%9A%E6%97%B6%E5%99%A8Timer"><span class="nav-text">（1）定时器Timer</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%882%EF%BC%89%E6%89%93%E7%82%B9%E5%99%A8Ticker"><span class="nav-text">（2）打点器Ticker</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%883%EF%BC%89%E9%80%9F%E7%8E%87%E9%99%90%E5%88%B6"><span class="nav-text">（3）速率限制</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-Goroutine%E6%B1%A0"><span class="nav-text">6.Goroutine池</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%881%EF%BC%89%E5%88%9B%E5%BB%BA%E5%B7%A5%E4%BD%9C%E6%B1%A0"><span class="nav-text">（1）创建工作池</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%882%EF%BC%89%E4%BD%BF%E7%94%A8%E5%B7%A5%E4%BD%9C%E6%B1%A0"><span class="nav-text">（2）使用工作池</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-Sync"><span class="nav-text">7.Sync</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%881%EF%BC%89WaitGroup"><span class="nav-text">（1）WaitGroup</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#8-%E5%B9%B6%E5%8F%91%E5%AE%89%E5%85%A8"><span class="nav-text">8.并发安全</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%881%EF%BC%89%E4%BA%92%E6%96%A5%E9%94%81"><span class="nav-text">（1）互斥锁</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%882%EF%BC%89atomic%EF%BC%88%E5%8E%9F%E5%AD%90%E6%93%8D%E4%BD%9C%EF%BC%89"><span class="nav-text">（2）atomic（原子操作）</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%883%EF%BC%89%E7%8A%B6%E6%80%81%E5%8D%8F%E7%A8%8B"><span class="nav-text">（3）状态协程</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8E%92%E5%BA%8F"><span class="nav-text">排序</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8E%92%E5%BA%8F"><span class="nav-text">1.自定义排序</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#JSON"><span class="nav-text">JSON</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="nav-text">1.基本概念</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E6%9E%84%E9%80%A0%E7%BB%93%E6%9E%84%E4%BD%93"><span class="nav-text">2.构造结构体</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E7%BC%96%E7%A0%81"><span class="nav-text">3.编码</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%881%EF%BC%89map%E7%B1%BB%E5%9E%8B%E7%BC%96%E7%A0%81"><span class="nav-text">（1）map类型编码</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%882%EF%BC%89%E8%87%AA%E5%AE%9A%E4%B9%89%E7%B1%BB%E5%9E%8B%E7%BC%96%E7%A0%81"><span class="nav-text">（2）自定义类型编码</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-%E8%A7%A3%E7%A0%81"><span class="nav-text">4.解码</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%881%EF%BC%89map%E7%B1%BB%E5%9E%8B%E6%8E%A5%E6%94%B6"><span class="nav-text">（1）map类型接收</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%882%EF%BC%89%E8%87%AA%E5%AE%9A%E4%B9%89%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E6%8E%A5%E6%94%B6"><span class="nav-text">（2）自定义数据类型接收</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%883%EF%BC%89Encode%E6%8E%A5%E6%94%B6"><span class="nav-text">（3）Encode接收</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95"><span class="nav-text">单元测试</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E5%91%BD%E5%90%8D%E8%A7%84%E5%88%99"><span class="nav-text">1.单元测试命名规则</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E8%A2%AB%E6%B5%8B%E5%AF%B9%E8%B1%A1"><span class="nav-text">2.被测对象</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E4%B8%80%E8%88%AC%E6%B5%8B%E8%AF%95%E4%BE%8B"><span class="nav-text">3.一般测试例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-%E8%A1%A8%E9%A9%B1%E5%8A%A8%E6%B5%8B%E8%AF%95%E4%BE%8B"><span class="nav-text">4.表驱动测试例</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HTTP%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="nav-text">HTTP客户端</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-GET%E8%AF%B7%E6%B1%82"><span class="nav-text">1.GET请求</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E5%B8%A6%E5%8F%82%E6%95%B0GET%E8%AF%B7%E6%B1%82"><span class="nav-text">2.带参数GET请求</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-POST%E8%AF%B7%E6%B1%82"><span class="nav-text">3.POST请求</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%881%EF%BC%89%E5%8F%91%E9%80%81from-data"><span class="nav-text">（1）发送from-data</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%882%EF%BC%89%E5%8F%91%E9%80%81json"><span class="nav-text">（2）发送json</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HTTP%E6%9C%8D%E5%8A%A1%E7%AB%AF"><span class="nav-text">HTTP服务端</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E6%99%AE%E9%80%9A%E6%9C%8D%E5%8A%A1"><span class="nav-text">1.普通服务</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%881%EF%BC%89%E5%A4%84%E7%90%86http%E8%AF%B7%E6%B1%82"><span class="nav-text">（1）处理http请求</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%882%EF%BC%89%E5%87%BD%E6%95%B0%E6%B3%A8%E5%86%8C%E5%88%B0%E8%B7%AF%E7%94%B1"><span class="nav-text">（2）函数注册到路由</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E6%8E%A5%E5%8F%97GET%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0"><span class="nav-text">2.接受GET请求参数</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%881%EF%BC%89%E5%A4%84%E7%90%86get%E8%AF%B7%E6%B1%82"><span class="nav-text">（1）处理get请求</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%882%EF%BC%89%E5%87%BD%E6%95%B0%E6%B3%A8%E5%86%8C%E5%88%B0%E8%B7%AF%E7%94%B1-1"><span class="nav-text">（2）函数注册到路由</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E6%8E%A5%E5%8F%97POST%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0"><span class="nav-text">3.接受POST请求参数</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%881%EF%BC%89%E5%A4%84%E7%90%86post%E8%AF%B7%E6%B1%82%E5%87%BD%E6%95%B0"><span class="nav-text">（1）处理post请求函数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%882%EF%BC%89%E5%87%BD%E6%95%B0%E6%B3%A8%E5%86%8C%E5%88%B0%E8%B7%AF%E7%94%B1-2"><span class="nav-text">（2）函数注册到路由</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%883%EF%BC%89%E8%AF%B7%E6%B1%82%E7%B1%BB%E5%9E%8B%E4%B8%BAapplication-x-www-form-urlencoded"><span class="nav-text">（3）请求类型为application&#x2F;x-www-form-urlencoded</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%EF%BC%883%EF%BC%89%E8%AF%B7%E6%B1%82%E7%B1%BB%E5%9E%8B%E4%B8%BAapplication-json"><span class="nav-text">（3）请求类型为application&#x2F;json</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%93%E6%9D%9F"><span class="nav-text">结束</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
<a href="/">  <img class="site-author-image" itemprop="image" alt="Autovy"
      src="/images/2.png">  </a>
  <p class="site-author-name" itemprop="name">Autovy</p>
  <div class="site-description" itemprop="description">新时代农民工的数字农田</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">43</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">51</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/Autovy" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Autovy" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://blog.csdn.net/JohnSmith232" title="CSDN → https:&#x2F;&#x2F;blog.csdn.net&#x2F;JohnSmith232" rel="noopener" target="_blank"><i class="fa fa-fw fa-code"></i>CSDN</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 2020 – 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-code"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Autovy</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    <span title="站点总字数">499k</span>
</div>

<!-- 在网页底部添加网站运行时间 -->
<span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span>
<script>
    var now = new Date();
    function createtime() {
        var grt= new Date("01/01/2020 00:00:00");//此处修改你的建站时间或者网站上线时间
        now.setTime(now.getTime()+250);
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;}
        document.getElementById("timeDate").innerHTML = "Run for "+dnum+" Days ";
        document.getElementById("times").innerHTML = hnum + " Hours " + mnum + " m " + snum + " s";
    }
setInterval("createtime()",250);
</script>


    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv" title="总访客量">
    本站已有
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    位访客
    <i class="fa fa-user"></i>
    </span>
  
<span> | </span>

  
    <span class="site-pv" title="总访问量">
   
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    次阅读
    <i class="fa fa-eye"></i>
    </span>
  
</div>







      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'RVJRabsBhxWXvhMcG8CH5wbc-gzGzoHsz',
      appKey     : 'JSGLk7guOagDPMFN9wbASkEh',
      placeholder: "说点什么吧",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : 'zh-cn' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
  <script src="/js/bloom.js" type="text/javascript"></script>